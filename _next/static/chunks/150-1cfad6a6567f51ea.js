(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{4478:function(n,i,o){"use strict";n.exports=function(n,i){n=n||document.body;var o=[.01,1/0];"distanceLimits"in(i=i||{})&&(o[0]=i.distanceLimits[0],o[1]=i.distanceLimits[1]),"zoomMin"in i&&(o[0]=i.zoomMin),"zoomMax"in i&&(o[1]=i.zoomMax);var h=a({center:i.center||[0,0,0],up:i.up||[0,1,0],eye:i.eye||[0,0,10],mode:i.mode||"orbit",distanceLimits:o}),f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0,m=n.clientWidth,_=n.clientHeight,v={view:h,element:n,delay:i.delay||16,rotateSpeed:i.rotateSpeed||1,zoomSpeed:i.zoomSpeed||1,translateSpeed:i.translateSpeed||1,flipX:!!i.flipX,flipY:!!i.flipY,modes:h.modes,tick:function(){var i=s(),o=this.delay;h.idle(i-o),h.flush(i-(100+2*o));var a=i-2*o;h.recalcMatrix(a);for(var l=!0,c=h.computedMatrix,u=0;u<16;++u)l=l&&f[u]===c[u],f[u]=c[u];var d=n.clientWidth===m&&n.clientHeight===_;return(m=n.clientWidth,_=n.clientHeight,l)?!d:(p=Math.exp(h.computedRadius[0]),!0)},lookAt:function(n,i,o){h.lookAt(h.lastT(),n,i,o)},rotate:function(n,i,o){h.rotate(h.lastT(),n,i,o)},pan:function(n,i,o){h.pan(h.lastT(),n,i,o)},translate:function(n,i,o){h.translate(h.lastT(),n,i,o)}};Object.defineProperties(v,{matrix:{get:function(){return h.computedMatrix},set:function(n){return h.setMatrix(h.lastT(),n),h.computedMatrix},enumerable:!0},mode:{get:function(){return h.getMode()},set:function(n){return h.setMode(n),h.getMode()},enumerable:!0},center:{get:function(){return h.computedCenter},set:function(n){return h.lookAt(h.lastT(),n),h.computedCenter},enumerable:!0},eye:{get:function(){return h.computedEye},set:function(n){return h.lookAt(h.lastT(),null,n),h.computedEye},enumerable:!0},up:{get:function(){return h.computedUp},set:function(n){return h.lookAt(h.lastT(),null,null,n),h.computedUp},enumerable:!0},distance:{get:function(){return p},set:function(n){return h.setDistance(h.lastT(),n),n},enumerable:!0},distanceLimits:{get:function(){return h.getDistanceLimits(o)},set:function(n){return h.setDistanceLimits(n),n},enumerable:!0}}),n.addEventListener("contextmenu",function(n){return n.preventDefault(),!1});var g=0,b=0,y={shift:!1,control:!1,alt:!1,meta:!1};function handleInteraction(i,o,a,l){var c=1/n.clientHeight,u=c*(o-g),d=c*(a-b),f=v.flipX?1:-1,m=v.flipY?1:-1,_=Math.PI*v.rotateSpeed,x=s();if(1&i)l.shift?h.rotate(x,0,0,-u*_):h.rotate(x,f*_*u,-m*_*d,0);else if(2&i)h.pan(x,-v.translateSpeed*u*p,v.translateSpeed*d*p,0);else if(4&i){var w=v.zoomSpeed*d/window.innerHeight*(x-h.lastT())*50;h.pan(x,0,0,p*(Math.exp(w)-1))}g=o,b=a,y=l}return l(n,handleInteraction),n.addEventListener("touchstart",function(i){var o=u(i.changedTouches[0],n);handleInteraction(0,o[0],o[1],y),handleInteraction(1,o[0],o[1],y),i.preventDefault()},!!d&&{passive:!1}),n.addEventListener("touchmove",function(i){var o=u(i.changedTouches[0],n);handleInteraction(1,o[0],o[1],y),i.preventDefault()},!!d&&{passive:!1}),n.addEventListener("touchend",function(i){u(i.changedTouches[0],n),handleInteraction(0,g,b,y),i.preventDefault()},!!d&&{passive:!1}),c(n,function(n,i,o){var a=v.flipX?1:-1,l=v.flipY?1:-1,c=s();if(Math.abs(n)>Math.abs(i))h.rotate(c,0,0,-n*a*Math.PI*v.rotateSpeed/window.innerWidth);else{var u=v.zoomSpeed*l*i/window.innerHeight*(c-h.lastT())/100;h.pan(c,0,0,p*(Math.exp(u)-1))}},!0),v};var s=o(698),a=o(3991),l=o(685),c=o(2232),u=o(675),d=o(6795)},3991:function(n,i,o){"use strict";n.exports=function(n){var i=(n=n||{}).eye||[0,0,1],o=n.center||[0,0,0],c=n.up||[0,1,0],u=n.distanceLimits||[0,1/0],d=n.mode||"turntable",h=s(),f=a(),p=l();return h.setDistanceLimits(u[0],u[1]),h.lookAt(0,i,o,c),f.setDistanceLimits(u[0],u[1]),f.lookAt(0,i,o,c),p.setDistanceLimits(u[0],u[1]),p.lookAt(0,i,o,c),new ViewController({turntable:h,orbit:f,matrix:p},d)};var s=o(8786),a=o(809),l=o(7622);function ViewController(n,i){this._controllerNames=Object.keys(n),this._controllerList=this._controllerNames.map(function(i){return n[i]}),this._mode=i,this._active=n[i],this._active||(this._mode="turntable",this._active=n.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var c=ViewController.prototype;c.flush=function(n){for(var i=this._controllerList,o=0;o<i.length;++o)i[o].flush(n)},c.idle=function(n){for(var i=this._controllerList,o=0;o<i.length;++o)i[o].idle(n)},c.lookAt=function(n,i,o,s){for(var a=this._controllerList,l=0;l<a.length;++l)a[l].lookAt(n,i,o,s)},c.rotate=function(n,i,o,s){for(var a=this._controllerList,l=0;l<a.length;++l)a[l].rotate(n,i,o,s)},c.pan=function(n,i,o,s){for(var a=this._controllerList,l=0;l<a.length;++l)a[l].pan(n,i,o,s)},c.translate=function(n,i,o,s){for(var a=this._controllerList,l=0;l<a.length;++l)a[l].translate(n,i,o,s)},c.setMatrix=function(n,i){for(var o=this._controllerList,s=0;s<o.length;++s)o[s].setMatrix(n,i)},c.setDistanceLimits=function(n,i){for(var o=this._controllerList,s=0;s<o.length;++s)o[s].setDistanceLimits(n,i)},c.setDistance=function(n,i){for(var o=this._controllerList,s=0;s<o.length;++s)o[s].setDistance(n,i)},c.recalcMatrix=function(n){this._active.recalcMatrix(n)},c.getDistance=function(n){return this._active.getDistance(n)},c.getDistanceLimits=function(n){return this._active.getDistanceLimits(n)},c.lastT=function(){return this._active.lastT()},c.setMode=function(n){if(n!==this._mode){var i=this._controllerNames.indexOf(n);if(!(i<0)){var o=this._active,s=this._controllerList[i],a=Math.max(o.lastT(),s.lastT());o.recalcMatrix(a),s.setMatrix(a,o.computedMatrix),this._active=s,this._mode=n,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},c.getMode=function(){return this._mode}},3076:function(n){"use strict";function ge(n,i,o,s,a){for(var l=a+1;s<=a;){var c=s+a>>>1,u=n[c];(void 0!==o?o(u,i):u-i)>=0?(l=c,a=c-1):s=c+1}return l}function gt(n,i,o,s,a){for(var l=a+1;s<=a;){var c=s+a>>>1,u=n[c];(void 0!==o?o(u,i):u-i)>0?(l=c,a=c-1):s=c+1}return l}function lt(n,i,o,s,a){for(var l=s-1;s<=a;){var c=s+a>>>1,u=n[c];(void 0!==o?o(u,i):u-i)<0?(l=c,s=c+1):a=c-1}return l}function le(n,i,o,s,a){for(var l=s-1;s<=a;){var c=s+a>>>1,u=n[c];(void 0!==o?o(u,i):u-i)<=0?(l=c,s=c+1):a=c-1}return l}function eq(n,i,o,s,a){for(;s<=a;){var l=s+a>>>1,c=n[l],u=void 0!==o?o(c,i):c-i;if(0===u)return l;u<=0?s=l+1:a=l-1}return -1}function norm(n,i,o,s,a,l){return"function"==typeof o?l(n,i,o,void 0===s?0:0|s,void 0===a?n.length-1:0|a):l(n,i,void 0,void 0===o?0:0|o,void 0===s?n.length-1:0|s)}n.exports={ge:function(n,i,o,s,a){return norm(n,i,o,s,a,ge)},gt:function(n,i,o,s,a){return norm(n,i,o,s,a,gt)},lt:function(n,i,o,s,a){return norm(n,i,o,s,a,lt)},le:function(n,i,o,s,a){return norm(n,i,o,s,a,le)},eq:function(n,i,o,s,a){return norm(n,i,o,s,a,eq)}}},617:function(n){"use strict";n.exports=function(n,i,o,s,a,l){var c=a-1,u=a*a,d=c*c,h=(1+2*a)*d,f=a*d,p=u*(3-2*a),m=u*c;if(n.length){l||(l=Array(n.length));for(var _=n.length-1;_>=0;--_)l[_]=h*n[_]+f*i[_]+p*o[_]+m*s[_];return l}return h*n+f*i+p*o+m*s},n.exports.derivative=function(n,i,o,s,a,l){var c=6*a*a-6*a,u=3*a*a-4*a+1,d=-6*a*a+6*a,h=3*a*a-2*a;if(n.length){l||(l=Array(n.length));for(var f=n.length-1;f>=0;--f)l[f]=c*n[f]+u*i[f]+d*o[f]+h*s[f];return l}return c*n+u*i+d*o[f]+h*s}},4376:function(n,i,o){"use strict";function colorToString(n,i){var o=n.__state.conversionName.toString(),s=Math.round(n.r),a=Math.round(n.g),l=Math.round(n.b),c=n.a,u=Math.round(n.h),d=n.s.toFixed(1),h=n.v.toFixed(1);if(i||"THREE_CHAR_HEX"===o||"SIX_CHAR_HEX"===o){for(var f=n.hex.toString(16);f.length<6;)f="0"+f;return"#"+f}if("CSS_RGB"===o)return"rgb("+s+","+a+","+l+")";if("CSS_RGBA"===o)return"rgba("+s+","+a+","+l+","+c+")";if("HEX"===o)return"0x"+n.hex.toString(16);if("RGB_ARRAY"===o)return"["+s+","+a+","+l+"]";if("RGBA_ARRAY"===o)return"["+s+","+a+","+l+","+c+"]";if("RGB_OBJ"===o)return"{r:"+s+",g:"+a+",b:"+l+"}";else if("RGBA_OBJ"===o)return"{r:"+s+",g:"+a+",b:"+l+",a:"+c+"}";else if("HSV_OBJ"===o)return"{h:"+u+",s:"+d+",v:"+h+"}";else if("HSVA_OBJ"===o)return"{h:"+u+",s:"+d+",v:"+h+",a:"+c+"}";return"unknown format"}o.r(i),o.d(i,{GUI:function(){return z},color:function(){return U},controllers:function(){return V},dom:function(){return F},gui:function(){return G}});var s=Array.prototype.forEach,a=Array.prototype.slice,l={BREAK:{},extend:function(n){return this.each(a.call(arguments,1),function(i){(this.isObject(i)?Object.keys(i):[]).forEach((function(o){this.isUndefined(i[o])||(n[o]=i[o])}).bind(this))},this),n},defaults:function(n){return this.each(a.call(arguments,1),function(i){(this.isObject(i)?Object.keys(i):[]).forEach((function(o){this.isUndefined(n[o])&&(n[o]=i[o])}).bind(this))},this),n},compose:function(){var n=a.call(arguments);return function(){for(var i=a.call(arguments),o=n.length-1;o>=0;o--)i=[n[o].apply(this,i)];return i[0]}},each:function(n,i,o){if(n){if(s&&n.forEach&&n.forEach===s)n.forEach(i,o);else if(n.length===n.length+0){var a=void 0,l=void 0;for(a=0,l=n.length;a<l;a++)if(a in n&&i.call(o,n[a],a)===this.BREAK)return}else for(var c in n)if(i.call(o,n[c],c)===this.BREAK)return}},defer:function(n){setTimeout(n,0)},debounce:function(n,i,o){var s=void 0;return function(){var a=this,l=arguments,c=o||!s;clearTimeout(s),s=setTimeout(function(){s=null,o||n.apply(a,l)},i),c&&n.apply(a,l)}},toArray:function(n){return n.toArray?n.toArray():a.call(n)},isUndefined:function(n){return void 0===n},isNull:function(n){return null===n},isNaN:function(n){function isNaN(i){return n.apply(this,arguments)}return isNaN.toString=function(){return n.toString()},isNaN}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(n){return n===Object(n)},isNumber:function(n){return n===n+0},isString:function(n){return n===n+""},isBoolean:function(n){return!1===n||!0===n},isFunction:function(n){return n instanceof Function}},c=[{litmus:l.isString,conversions:{THREE_CHAR_HEX:{read:function(n){var i=n.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==i&&{space:"HEX",hex:parseInt("0x"+i[1].toString()+i[1].toString()+i[2].toString()+i[2].toString()+i[3].toString()+i[3].toString(),0)}},write:colorToString},SIX_CHAR_HEX:{read:function(n){var i=n.match(/^#([A-F0-9]{6})$/i);return null!==i&&{space:"HEX",hex:parseInt("0x"+i[1].toString(),0)}},write:colorToString},CSS_RGB:{read:function(n){var i=n.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==i&&{space:"RGB",r:parseFloat(i[1]),g:parseFloat(i[2]),b:parseFloat(i[3])}},write:colorToString},CSS_RGBA:{read:function(n){var i=n.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==i&&{space:"RGB",r:parseFloat(i[1]),g:parseFloat(i[2]),b:parseFloat(i[3]),a:parseFloat(i[4])}},write:colorToString}}},{litmus:l.isNumber,conversions:{HEX:{read:function(n){return{space:"HEX",hex:n,conversionName:"HEX"}},write:function(n){return n.hex}}}},{litmus:l.isArray,conversions:{RGB_ARRAY:{read:function(n){return 3===n.length&&{space:"RGB",r:n[0],g:n[1],b:n[2]}},write:function(n){return[n.r,n.g,n.b]}},RGBA_ARRAY:{read:function(n){return 4===n.length&&{space:"RGB",r:n[0],g:n[1],b:n[2],a:n[3]}},write:function(n){return[n.r,n.g,n.b,n.a]}}}},{litmus:l.isObject,conversions:{RGBA_OBJ:{read:function(n){return!!(l.isNumber(n.r)&&l.isNumber(n.g)&&l.isNumber(n.b)&&l.isNumber(n.a))&&{space:"RGB",r:n.r,g:n.g,b:n.b,a:n.a}},write:function(n){return{r:n.r,g:n.g,b:n.b,a:n.a}}},RGB_OBJ:{read:function(n){return!!(l.isNumber(n.r)&&l.isNumber(n.g)&&l.isNumber(n.b))&&{space:"RGB",r:n.r,g:n.g,b:n.b}},write:function(n){return{r:n.r,g:n.g,b:n.b}}},HSVA_OBJ:{read:function(n){return!!(l.isNumber(n.h)&&l.isNumber(n.s)&&l.isNumber(n.v)&&l.isNumber(n.a))&&{space:"HSV",h:n.h,s:n.s,v:n.v,a:n.a}},write:function(n){return{h:n.h,s:n.s,v:n.v,a:n.a}}},HSV_OBJ:{read:function(n){return!!(l.isNumber(n.h)&&l.isNumber(n.s)&&l.isNumber(n.v))&&{space:"HSV",h:n.h,s:n.s,v:n.v}},write:function(n){return{h:n.h,s:n.s,v:n.v}}}}}],u=void 0,d=void 0,interpret=function(){d=!1;var n=arguments.length>1?l.toArray(arguments):arguments[0];return l.each(c,function(i){if(i.litmus(n))return l.each(i.conversions,function(i,o){if(u=i.read(n),!1===d&&!1!==u)return d=u,u.conversionName=o,u.conversion=i,l.BREAK}),l.BREAK}),d},h=void 0,f={hsv_to_rgb:function(n,i,o){var s=n/60-Math.floor(n/60),a=o*(1-i),l=o*(1-s*i),c=o*(1-(1-s)*i),u=[[o,c,a],[l,o,a],[a,o,c],[a,l,o],[c,a,o],[o,a,l]][Math.floor(n/60)%6];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(n,i,o){var s=Math.max(n,i,o),a=s-Math.min(n,i,o),l=void 0,c=void 0;return 0===s?{h:NaN,s:0,v:0}:(c=a/s,(l=(n===s?(i-o)/a:i===s?2+(o-n)/a:4+(n-i)/a)/6)<0&&(l+=1),{h:360*l,s:c,v:s/255})},rgb_to_hex:function(n,i,o){var s=this.hex_with_component(0,2,n);return s=this.hex_with_component(s,1,i),s=this.hex_with_component(s,0,o)},component_from_hex:function(n,i){return n>>8*i&255},hex_with_component:function(n,i,o){return o<<(h=8*i)|n&~(255<<h)}},p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},classCallCheck=function(n,i){if(!(n instanceof i))throw TypeError("Cannot call a class as a function")},m=function(){function defineProperties(n,i){for(var o=0;o<i.length;o++){var s=i[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}return function(n,i,o){return i&&defineProperties(n.prototype,i),o&&defineProperties(n,o),n}}(),get=function get(n,i,o){null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,i);if(void 0===s){var a=Object.getPrototypeOf(n);if(null===a)return;return get(a,i,o)}if("value"in s)return s.value;var l=s.get;if(void 0!==l)return l.call(o)},inherits=function(n,i){if("function"!=typeof i&&null!==i)throw TypeError("Super expression must either be null or a function, not "+typeof i);n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(n,i):n.__proto__=i)},possibleConstructorReturn=function(n,i){if(!n)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return i&&("object"==typeof i||"function"==typeof i)?i:n},_=function(){function Color(){if(classCallCheck(this,Color),this.__state=interpret.apply(this,arguments),!1===this.__state)throw Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return m(Color,[{key:"toString",value:function(){return colorToString(this)}},{key:"toHexString",value:function(){return colorToString(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),Color}();function defineRGBComponent(n,i,o){Object.defineProperty(n,i,{get:function(){return"RGB"===this.__state.space||_.recalculateRGB(this,i,o),this.__state[i]},set:function(n){"RGB"!==this.__state.space&&(_.recalculateRGB(this,i,o),this.__state.space="RGB"),this.__state[i]=n}})}function defineHSVComponent(n,i){Object.defineProperty(n,i,{get:function(){return"HSV"===this.__state.space||_.recalculateHSV(this),this.__state[i]},set:function(n){"HSV"!==this.__state.space&&(_.recalculateHSV(this),this.__state.space="HSV"),this.__state[i]=n}})}_.recalculateRGB=function(n,i,o){if("HEX"===n.__state.space)n.__state[i]=f.component_from_hex(n.__state.hex,o);else if("HSV"===n.__state.space)l.extend(n.__state,f.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw Error("Corrupted color state")},_.recalculateHSV=function(n){var i=f.rgb_to_hsv(n.r,n.g,n.b);l.extend(n.__state,{s:i.s,v:i.v}),l.isNaN(i.h)?l.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=i.h},_.COMPONENTS=["r","g","b","h","s","v","hex","a"],defineRGBComponent(_.prototype,"r",2),defineRGBComponent(_.prototype,"g",1),defineRGBComponent(_.prototype,"b",0),defineHSVComponent(_.prototype,"h"),defineHSVComponent(_.prototype,"s"),defineHSVComponent(_.prototype,"v"),Object.defineProperty(_.prototype,"a",{get:function(){return this.__state.a},set:function(n){this.__state.a=n}}),Object.defineProperty(_.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=f.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(n){this.__state.space="HEX",this.__state.hex=n}});var v=function(){function Controller(n,i){classCallCheck(this,Controller),this.initialValue=n[i],this.domElement=document.createElement("div"),this.object=n,this.property=i,this.__onChange=void 0,this.__onFinishChange=void 0}return m(Controller,[{key:"onChange",value:function(n){return this.__onChange=n,this}},{key:"onFinishChange",value:function(n){return this.__onFinishChange=n,this}},{key:"setValue",value:function(n){return this.object[this.property]=n,this.__onChange&&this.__onChange.call(this,n),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),Controller}(),g={};l.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(n,i){l.each(n,function(n){g[n]=i})});var b=/(\d+(\.\d+)?)px/;function cssValueToPixels(n){if("0"===n||l.isUndefined(n))return 0;var i=n.match(b);return l.isNull(i)?0:parseFloat(i[1])}var y={makeSelectable:function(n,i){void 0!==n&&void 0!==n.style&&(n.onselectstart=i?function(){return!1}:function(){},n.style.MozUserSelect=i?"auto":"none",n.style.KhtmlUserSelect=i?"auto":"none",n.unselectable=i?"on":"off")},makeFullscreen:function(n,i,o){var s=o,a=i;l.isUndefined(a)&&(a=!0),l.isUndefined(s)&&(s=!0),n.style.position="absolute",a&&(n.style.left=0,n.style.right=0),s&&(n.style.top=0,n.style.bottom=0)},fakeEvent:function(n,i,o,s){var a=o||{},c=g[i];if(!c)throw Error("Event type "+i+" not supported.");var u=document.createEvent(c);switch(c){case"MouseEvents":var d=a.x||a.clientX||0,h=a.y||a.clientY||0;u.initMouseEvent(i,a.bubbles||!1,a.cancelable||!0,window,a.clickCount||1,0,0,d,h,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var f=u.initKeyboardEvent||u.initKeyEvent;l.defaults(a,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),f(i,a.bubbles||!1,a.cancelable,window,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);break;default:u.initEvent(i,a.bubbles||!1,a.cancelable||!0)}l.defaults(u,s),n.dispatchEvent(u)},bind:function(n,i,o,s){return n.addEventListener?n.addEventListener(i,o,s||!1):n.attachEvent&&n.attachEvent("on"+i,o),y},unbind:function(n,i,o,s){return n.removeEventListener?n.removeEventListener(i,o,s||!1):n.detachEvent&&n.detachEvent("on"+i,o),y},addClass:function(n,i){if(void 0===n.className)n.className=i;else if(n.className!==i){var o=n.className.split(/ +/);-1===o.indexOf(i)&&(o.push(i),n.className=o.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return y},removeClass:function(n,i){if(i){if(n.className===i)n.removeAttribute("class");else{var o=n.className.split(/ +/),s=o.indexOf(i);-1!==s&&(o.splice(s,1),n.className=o.join(" "))}}else n.className=void 0;return y},hasClass:function(n,i){return RegExp("(?:^|\\s+)"+i+"(?:\\s+|$)").test(n.className)||!1},getWidth:function(n){var i=getComputedStyle(n);return cssValueToPixels(i["border-left-width"])+cssValueToPixels(i["border-right-width"])+cssValueToPixels(i["padding-left"])+cssValueToPixels(i["padding-right"])+cssValueToPixels(i.width)},getHeight:function(n){var i=getComputedStyle(n);return cssValueToPixels(i["border-top-width"])+cssValueToPixels(i["border-bottom-width"])+cssValueToPixels(i["padding-top"])+cssValueToPixels(i["padding-bottom"])+cssValueToPixels(i.height)},getOffset:function(n){var i=n,o={left:0,top:0};if(i.offsetParent)do o.left+=i.offsetLeft,o.top+=i.offsetTop,i=i.offsetParent;while(i);return o},isActive:function(n){return n===document.activeElement&&(n.type||n.href)}},x=function(n){function BooleanController(n,i){classCallCheck(this,BooleanController);var o=possibleConstructorReturn(this,(BooleanController.__proto__||Object.getPrototypeOf(BooleanController)).call(this,n,i));return o.__prev=o.getValue(),o.__checkbox=document.createElement("input"),o.__checkbox.setAttribute("type","checkbox"),y.bind(o.__checkbox,"change",function(){o.setValue(!o.__prev)},!1),o.domElement.appendChild(o.__checkbox),o.updateDisplay(),o}return inherits(BooleanController,n),m(BooleanController,[{key:"setValue",value:function(n){var i=get(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"setValue",this).call(this,n);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),get(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"updateDisplay",this).call(this)}}]),BooleanController}(v),w=function(n){function OptionController(n,i,o){classCallCheck(this,OptionController);var s=possibleConstructorReturn(this,(OptionController.__proto__||Object.getPrototypeOf(OptionController)).call(this,n,i)),a=o;if(s.__select=document.createElement("select"),l.isArray(a)){var c={};l.each(a,function(n){c[n]=n}),a=c}return l.each(a,function(n,i){var o=document.createElement("option");o.innerHTML=i,o.setAttribute("value",n),s.__select.appendChild(o)}),s.updateDisplay(),y.bind(s.__select,"change",function(){var n=this.options[this.selectedIndex].value;s.setValue(n)}),s.domElement.appendChild(s.__select),s}return inherits(OptionController,n),m(OptionController,[{key:"setValue",value:function(n){var i=get(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"setValue",this).call(this,n);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return y.isActive(this.__select)?this:(this.__select.value=this.getValue(),get(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"updateDisplay",this).call(this))}}]),OptionController}(v),C=function(n){function StringController(n,i){classCallCheck(this,StringController);var o=possibleConstructorReturn(this,(StringController.__proto__||Object.getPrototypeOf(StringController)).call(this,n,i));function onChange(){o.setValue(o.__input.value)}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),y.bind(o.__input,"keyup",onChange),y.bind(o.__input,"change",onChange),y.bind(o.__input,"blur",function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}),y.bind(o.__input,"keydown",function(n){13===n.keyCode&&this.blur()}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return inherits(StringController,n),m(StringController,[{key:"updateDisplay",value:function(){return y.isActive(this.__input)||(this.__input.value=this.getValue()),get(StringController.prototype.__proto__||Object.getPrototypeOf(StringController.prototype),"updateDisplay",this).call(this)}}]),StringController}(v);function numDecimals(n){var i=n.toString();return i.indexOf(".")>-1?i.length-i.indexOf(".")-1:0}var M=function(n){function NumberController(n,i,o){classCallCheck(this,NumberController);var s=possibleConstructorReturn(this,(NumberController.__proto__||Object.getPrototypeOf(NumberController)).call(this,n,i)),a=o||{};return s.__min=a.min,s.__max=a.max,s.__step=a.step,l.isUndefined(s.__step)?0===s.initialValue?s.__impliedStep=1:s.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__impliedStep=s.__step,s.__precision=numDecimals(s.__impliedStep),s}return inherits(NumberController,n),m(NumberController,[{key:"setValue",value:function(n){var i=n;return void 0!==this.__min&&i<this.__min?i=this.__min:void 0!==this.__max&&i>this.__max&&(i=this.__max),void 0!==this.__step&&i%this.__step!=0&&(i=Math.round(i/this.__step)*this.__step),get(NumberController.prototype.__proto__||Object.getPrototypeOf(NumberController.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(n){return this.__min=n,this}},{key:"max",value:function(n){return this.__max=n,this}},{key:"step",value:function(n){return this.__step=n,this.__impliedStep=n,this.__precision=numDecimals(n),this}}]),NumberController}(v),E=function(n){function NumberControllerBox(n,i,o){classCallCheck(this,NumberControllerBox);var s=possibleConstructorReturn(this,(NumberControllerBox.__proto__||Object.getPrototypeOf(NumberControllerBox)).call(this,n,i,o));s.__truncationSuspended=!1;var a=void 0;function onFinish(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function onMouseDrag(n){var i=a-n.clientY;s.setValue(s.getValue()+i*s.__impliedStep),a=n.clientY}function onMouseUp(){y.unbind(window,"mousemove",onMouseDrag),y.unbind(window,"mouseup",onMouseUp),onFinish()}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),y.bind(s.__input,"change",function(){var n=parseFloat(s.__input.value);l.isNaN(n)||s.setValue(n)}),y.bind(s.__input,"blur",function(){onFinish()}),y.bind(s.__input,"mousedown",function(n){y.bind(window,"mousemove",onMouseDrag),y.bind(window,"mouseup",onMouseUp),a=n.clientY}),y.bind(s.__input,"keydown",function(n){13===n.keyCode&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,onFinish())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return inherits(NumberControllerBox,n),m(NumberControllerBox,[{key:"updateDisplay",value:function(){var n;return this.__input.value=this.__truncationSuspended?this.getValue():Math.round(this.getValue()*(n=Math.pow(10,this.__precision)))/n,get(NumberControllerBox.prototype.__proto__||Object.getPrototypeOf(NumberControllerBox.prototype),"updateDisplay",this).call(this)}}]),NumberControllerBox}(M),S=function(n){function NumberControllerSlider(n,i,o,s,a){classCallCheck(this,NumberControllerSlider);var l=possibleConstructorReturn(this,(NumberControllerSlider.__proto__||Object.getPrototypeOf(NumberControllerSlider)).call(this,n,i,{min:o,max:s,step:a}));function onMouseDrag(n){n.preventDefault();var i,o,s,a,c=l.__background.getBoundingClientRect();return l.setValue((i=n.clientX,o=c.left,s=c.right,(a=l.__min)+(l.__max-a)*((i-o)/(s-o)))),!1}function onMouseUp(){y.unbind(window,"mousemove",onMouseDrag),y.unbind(window,"mouseup",onMouseUp),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function onTouchMove(n){var i,o,s,a=n.touches[0].clientX,c=l.__background.getBoundingClientRect();l.setValue((i=c.left,o=c.right,(s=l.__min)+(l.__max-s)*((a-i)/(o-i))))}function onTouchEnd(){y.unbind(window,"touchmove",onTouchMove),y.unbind(window,"touchend",onTouchEnd),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),y.bind(l.__background,"mousedown",function(n){document.activeElement.blur(),y.bind(window,"mousemove",onMouseDrag),y.bind(window,"mouseup",onMouseUp),onMouseDrag(n)}),y.bind(l.__background,"touchstart",function(n){1===n.touches.length&&(y.bind(window,"touchmove",onTouchMove),y.bind(window,"touchend",onTouchEnd),onTouchMove(n))}),y.addClass(l.__background,"slider"),y.addClass(l.__foreground,"slider-fg"),l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return inherits(NumberControllerSlider,n),m(NumberControllerSlider,[{key:"updateDisplay",value:function(){var n=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*n+"%",get(NumberControllerSlider.prototype.__proto__||Object.getPrototypeOf(NumberControllerSlider.prototype),"updateDisplay",this).call(this)}}]),NumberControllerSlider}(M),k=function(n){function FunctionController(n,i,o){classCallCheck(this,FunctionController);var s=possibleConstructorReturn(this,(FunctionController.__proto__||Object.getPrototypeOf(FunctionController)).call(this,n,i));return s.__button=document.createElement("div"),s.__button.innerHTML=void 0===o?"Fire":o,y.bind(s.__button,"click",function(n){return n.preventDefault(),s.fire(),!1}),y.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return inherits(FunctionController,n),m(FunctionController,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),FunctionController}(v),A=function(n){function ColorController(n,i){classCallCheck(this,ColorController);var o,s=possibleConstructorReturn(this,(ColorController.__proto__||Object.getPrototypeOf(ColorController)).call(this,n,i));s.__color=new _(s.getValue()),s.__temp=new _(0),s.domElement=document.createElement("div"),y.makeSelectable(s.domElement,!1),s.__selector=document.createElement("div"),s.__selector.className="selector",s.__saturation_field=document.createElement("div"),s.__saturation_field.className="saturation-field",s.__field_knob=document.createElement("div"),s.__field_knob.className="field-knob",s.__field_knob_border="2px solid ",s.__hue_knob=document.createElement("div"),s.__hue_knob.className="hue-knob",s.__hue_field=document.createElement("div"),s.__hue_field.className="hue-field",s.__input=document.createElement("input"),s.__input.type="text",s.__input_textShadow="0 1px 1px ",y.bind(s.__input,"keydown",function(n){13===n.keyCode&&onBlur.call(this)}),y.bind(s.__input,"blur",onBlur),y.bind(s.__selector,"mousedown",function(){y.addClass(this,"drag").bind(window,"mouseup",function(){y.removeClass(s.__selector,"drag")})}),y.bind(s.__selector,"touchstart",function(){y.addClass(this,"drag").bind(window,"touchend",function(){y.removeClass(s.__selector,"drag")})});var a=document.createElement("div");function fieldDown(n){setSV(n),y.bind(window,"mousemove",setSV),y.bind(window,"touchmove",setSV),y.bind(window,"mouseup",fieldUpSV),y.bind(window,"touchend",fieldUpSV)}function fieldDownH(n){setH(n),y.bind(window,"mousemove",setH),y.bind(window,"touchmove",setH),y.bind(window,"mouseup",fieldUpH),y.bind(window,"touchend",fieldUpH)}function fieldUpSV(){y.unbind(window,"mousemove",setSV),y.unbind(window,"touchmove",setSV),y.unbind(window,"mouseup",fieldUpSV),y.unbind(window,"touchend",fieldUpSV),onFinish()}function fieldUpH(){y.unbind(window,"mousemove",setH),y.unbind(window,"touchmove",setH),y.unbind(window,"mouseup",fieldUpH),y.unbind(window,"touchend",fieldUpH),onFinish()}function onBlur(){var n=interpret(this.value);!1!==n?(s.__color.__state=n,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function onFinish(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}function setSV(n){-1===n.type.indexOf("touch")&&n.preventDefault();var i=s.__saturation_field.getBoundingClientRect(),o=n.touches&&n.touches[0]||n,a=o.clientX,l=o.clientY,c=(a-i.left)/(i.right-i.left),u=1-(l-i.top)/(i.bottom-i.top);return u>1?u=1:u<0&&(u=0),c>1?c=1:c<0&&(c=0),s.__color.v=u,s.__color.s=c,s.setValue(s.__color.toOriginal()),!1}function setH(n){-1===n.type.indexOf("touch")&&n.preventDefault();var i=s.__hue_field.getBoundingClientRect(),o=1-((n.touches&&n.touches[0]||n).clientY-i.top)/(i.bottom-i.top);return o>1?o=1:o<0&&(o=0),s.__color.h=360*o,s.setValue(s.__color.toOriginal()),!1}return l.extend(s.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),l.extend(s.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:s.__field_knob_border+(s.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),l.extend(s.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),l.extend(s.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),l.extend(a.style,{width:"100%",height:"100%",background:"none"}),linearGradient(a,"top","rgba(0,0,0,0)","#000"),l.extend(s.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(o=s.__hue_field).style.background="",o.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",o.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",l.extend(s.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:s.__input_textShadow+"rgba(0,0,0,0.7)"}),y.bind(s.__saturation_field,"mousedown",fieldDown),y.bind(s.__saturation_field,"touchstart",fieldDown),y.bind(s.__field_knob,"mousedown",fieldDown),y.bind(s.__field_knob,"touchstart",fieldDown),y.bind(s.__hue_field,"mousedown",fieldDownH),y.bind(s.__hue_field,"touchstart",fieldDownH),s.__saturation_field.appendChild(a),s.__selector.appendChild(s.__field_knob),s.__selector.appendChild(s.__saturation_field),s.__selector.appendChild(s.__hue_field),s.__hue_field.appendChild(s.__hue_knob),s.domElement.appendChild(s.__input),s.domElement.appendChild(s.__selector),s.updateDisplay(),s}return inherits(ColorController,n),m(ColorController,[{key:"updateDisplay",value:function(){var n=interpret(this.getValue());if(!1!==n){var i=!1;l.each(_.COMPONENTS,function(o){if(!l.isUndefined(n[o])&&!l.isUndefined(this.__color.__state[o])&&n[o]!==this.__color.__state[o])return i=!0,{}},this),i&&l.extend(this.__color.__state,n)}l.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,s=255-o;l.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,linearGradient(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),l.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}}]),ColorController}(v),T=["-moz-","-o-","-webkit-","-ms-",""];function linearGradient(n,i,o,s){n.style.background="",l.each(T,function(a){n.style.cssText+="background: "+a+"linear-gradient("+i+", "+o+" 0%, "+s+" 100%); "})}var ControllerFactory=function(n,i){var o=n[i];return l.isArray(arguments[2])||l.isObject(arguments[2])?new w(n,i,arguments[2]):l.isNumber(o)?l.isNumber(arguments[2])&&l.isNumber(arguments[3])?l.isNumber(arguments[4])?new S(n,i,arguments[2],arguments[3],arguments[4]):new S(n,i,arguments[2],arguments[3]):l.isNumber(arguments[4])?new E(n,i,{min:arguments[2],max:arguments[3],step:arguments[4]}):new E(n,i,{min:arguments[2],max:arguments[3]}):l.isString(o)?new C(n,i):l.isFunction(o)?new k(n,i,""):l.isBoolean(o)?new x(n,i):null},L=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){setTimeout(n,1e3/60)},O=function(){function CenteredDiv(){classCallCheck(this,CenteredDiv),this.backgroundElement=document.createElement("div"),l.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),y.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),l.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;y.bind(this.backgroundElement,"click",function(){n.hide()})}return m(CenteredDiv,[{key:"show",value:function(){var n=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),l.defer(function(){n.backgroundElement.style.opacity=1,n.domElement.style.opacity=1,n.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var n=this,hide=function hide(){n.domElement.style.display="none",n.backgroundElement.style.display="none",y.unbind(n.domElement,"webkitTransitionEnd",hide),y.unbind(n.domElement,"transitionend",hide),y.unbind(n.domElement,"oTransitionEnd",hide)};y.bind(this.domElement,"webkitTransitionEnd",hide),y.bind(this.domElement,"transitionend",hide),y.bind(this.domElement,"oTransitionEnd",hide),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-y.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-y.getHeight(this.domElement)/2+"px"}}]),CenteredDiv}();({load:function(n,i){var o=i||document,s=o.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=n,o.getElementsByTagName("head")[0].appendChild(s)},inject:function(n,i){var o=document.createElement("style");o.type="text/css",o.innerHTML=n;var s=(i||document).getElementsByTagName("head")[0];try{s.appendChild(o)}catch(n){}}}).inject(function(n){if(n&&"undefined"!=typeof window){var i=document.createElement("style");return i.setAttribute("type","text/css"),i.innerHTML=n,document.head.appendChild(i),n}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var R="Default",P=function(){try{return!!window.localStorage}catch(n){return!1}}(),B=void 0,D=!0,N=void 0,I=!1,H=[],GUI=function GUI(n){var i,o=this,s=n||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),y.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],s=l.defaults(s,{closeOnTop:!1,autoPlace:!0,width:GUI.DEFAULT_WIDTH}),s=l.defaults(s,{resizable:s.autoPlace,hideable:s.autoPlace}),l.isUndefined(s.load)?s.load={preset:R}:s.preset&&(s.load.preset=s.preset),l.isUndefined(s.parent)&&s.hideable&&H.push(this),s.resizable=l.isUndefined(s.parent)&&s.resizable,s.autoPlace&&l.isUndefined(s.scrollable)&&(s.scrollable=!0);var a=P&&"true"===localStorage.getItem(getLocalStorageHash(this,"isLocal")),c=void 0,u=void 0;if(Object.defineProperties(this,{parent:{get:function(){return s.parent}},scrollable:{get:function(){return s.scrollable}},autoPlace:{get:function(){return s.autoPlace}},closeOnTop:{get:function(){return s.closeOnTop}},preset:{get:function(){return o.parent?o.getRoot().preset:s.load.preset},set:function(n){o.parent?o.getRoot().preset=n:s.load.preset=n,function(n){for(var i=0;i<n.__preset_select.length;i++)n.__preset_select[i].value===n.preset&&(n.__preset_select.selectedIndex=i)}(this),o.revert()}},width:{get:function(){return s.width},set:function(n){s.width=n,setWidth(o,n)}},name:{get:function(){return s.name},set:function(n){s.name=n,u&&(u.innerHTML=s.name)}},closed:{get:function(){return s.closed},set:function(n){s.closed=n,s.closed?y.addClass(o.__ul,GUI.CLASS_CLOSED):y.removeClass(o.__ul,GUI.CLASS_CLOSED),this.onResize(),o.__closeButton&&(o.__closeButton.innerHTML=n?GUI.TEXT_OPEN:GUI.TEXT_CLOSED)}},load:{get:function(){return s.load}},useLocalStorage:{get:function(){return a},set:function(n){P&&(a=n,n?y.bind(window,"unload",c):y.unbind(window,"unload",c),localStorage.setItem(getLocalStorageHash(o,"isLocal"),n))}}}),l.isUndefined(s.parent)){if(this.closed=s.closed||!1,y.addClass(this.domElement,GUI.CLASS_MAIN),y.makeSelectable(this.domElement,!1),P&&a){o.useLocalStorage=!0;var d=localStorage.getItem(getLocalStorageHash(this,"gui"));d&&(s.load=JSON.parse(d))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=GUI.TEXT_CLOSED,y.addClass(this.__closeButton,GUI.CLASS_CLOSE_BUTTON),s.closeOnTop?(y.addClass(this.__closeButton,GUI.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(y.addClass(this.__closeButton,GUI.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),y.bind(this.__closeButton,"click",function(){o.closed=!o.closed})}else{void 0===s.closed&&(s.closed=!0);var h=document.createTextNode(s.name);y.addClass(h,"controller-name"),u=addRow(o,h),y.addClass(this.__ul,GUI.CLASS_CLOSED),y.addClass(u,"title"),y.bind(u,"click",function(n){return n.preventDefault(),o.closed=!o.closed,!1}),s.closed||(this.closed=!1)}s.autoPlace&&(l.isUndefined(s.parent)&&(D&&(N=document.createElement("div"),y.addClass(N,"dg"),y.addClass(N,GUI.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(N),D=!1),N.appendChild(this.domElement),y.addClass(this.domElement,GUI.CLASS_AUTO_PLACE)),this.parent||setWidth(o,s.width)),this.__resizeHandler=function(){o.onResizeDebounced()},y.bind(window,"resize",this.__resizeHandler),y.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),y.bind(this.__ul,"transitionend",this.__resizeHandler),y.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),s.resizable&&function(n){var i=void 0;function drag(o){return o.preventDefault(),n.width+=i-o.clientX,n.onResize(),i=o.clientX,!1}function dragStop(){y.removeClass(n.__closeButton,GUI.CLASS_DRAG),y.unbind(window,"mousemove",drag),y.unbind(window,"mouseup",dragStop)}function dragStart(o){return o.preventDefault(),i=o.clientX,y.addClass(n.__closeButton,GUI.CLASS_DRAG),y.bind(window,"mousemove",drag),y.bind(window,"mouseup",dragStop),!1}n.__resize_handle=document.createElement("div"),l.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),y.bind(n.__resize_handle,"mousedown",dragStart),y.bind(n.__closeButton,"mousedown",dragStart),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}(this),c=function(){P&&"true"===localStorage.getItem(getLocalStorageHash(o,"isLocal"))&&localStorage.setItem(getLocalStorageHash(o,"gui"),JSON.stringify(o.getSaveObject()))},this.saveToLocalStorageIfPossible=c,s.parent||(i=o.getRoot(),i.width+=1,l.defer(function(){i.width-=1}))};function addRow(n,i,o){var s=document.createElement("li");return i&&s.appendChild(i),o?n.__ul.insertBefore(s,o):n.__ul.appendChild(s),n.onResize(),s}function removeListeners(n){y.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&y.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function markPresetModified(n,i){var o=n.__preset_select[n.__preset_select.selectedIndex];i?o.innerHTML=o.value+"*":o.innerHTML=o.value}function recallSavedValue(n,i){var o=n.getRoot(),s=o.__rememberedObjects.indexOf(i.object);if(-1!==s){var a=o.__rememberedObjectIndecesToControllers[s];if(void 0===a&&(a={},o.__rememberedObjectIndecesToControllers[s]=a),a[i.property]=i,o.load&&o.load.remembered){var l=o.load.remembered,c=void 0;if(l[n.preset])c=l[n.preset];else{if(!l[R])return;c=l[R]}if(c[s]&&void 0!==c[s][i.property]){var u=c[s][i.property];i.initialValue=u,i.setValue(u)}}}}function _add(n,i,o,s){if(void 0===i[o])throw Error('Object "'+i+'" has no property "'+o+'"');var a=void 0;if(s.color)a=new A(i,o);else{var c=[i,o].concat(s.factoryArgs);a=ControllerFactory.apply(n,c)}s.before instanceof v&&(s.before=s.before.__li),recallSavedValue(n,a),y.addClass(a.domElement,"c");var u=document.createElement("span");y.addClass(u,"property-name"),u.innerHTML=a.property;var d=document.createElement("div");d.appendChild(u),d.appendChild(a.domElement);var h=addRow(n,d,s.before);return y.addClass(h,GUI.CLASS_CONTROLLER_ROW),a instanceof A?y.addClass(h,"color"):y.addClass(h,p(a.getValue())),!function(n,i,o){if(o.__li=i,o.__gui=n,l.extend(o,{options:function(i){if(arguments.length>1){var s=o.__li.nextElementSibling;return o.remove(),_add(n,o.object,o.property,{before:s,factoryArgs:[l.toArray(arguments)]})}if(l.isArray(i)||l.isObject(i)){var a=o.__li.nextElementSibling;return o.remove(),_add(n,o.object,o.property,{before:a,factoryArgs:[i]})}},name:function(n){return o.__li.firstElementChild.firstElementChild.innerHTML=n,o},listen:function(){return o.__gui.listen(o),o},remove:function(){return o.__gui.remove(o),o}}),o instanceof S){var s=new E(o.object,o.property,{min:o.__min,max:o.__max,step:o.__step});l.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(n){var i=o[n],a=s[n];o[n]=s[n]=function(){var n=Array.prototype.slice.call(arguments);return a.apply(s,n),i.apply(o,n)}}),y.addClass(i,"has-slider"),o.domElement.insertBefore(s.domElement,o.domElement.firstElementChild)}else if(o instanceof E){var r=function(i){if(l.isNumber(o.__min)&&l.isNumber(o.__max)){var s=o.__li.firstElementChild.firstElementChild.innerHTML,a=o.__gui.__listening.indexOf(o)>-1;o.remove();var c=_add(n,o.object,o.property,{before:o.__li.nextElementSibling,factoryArgs:[o.__min,o.__max,o.__step]});return c.name(s),a&&c.listen(),c}return i};o.min=l.compose(r,o.min),o.max=l.compose(r,o.max)}else o instanceof x?(y.bind(i,"click",function(){y.fakeEvent(o.__checkbox,"click")}),y.bind(o.__checkbox,"click",function(n){n.stopPropagation()})):o instanceof k?(y.bind(i,"click",function(){y.fakeEvent(o.__button,"click")}),y.bind(i,"mouseover",function(){y.addClass(o.__button,"hover")}),y.bind(i,"mouseout",function(){y.removeClass(o.__button,"hover")})):o instanceof A&&(y.addClass(i,"color"),o.updateDisplay=l.compose(function(n){return i.style.borderLeftColor=o.__color.toString(),n},o.updateDisplay),o.updateDisplay());o.setValue=l.compose(function(i){return n.getRoot().__preset_select&&o.isModified()&&markPresetModified(n.getRoot(),!0),i},o.setValue)}(n,h,a),n.__controllers.push(a),a}function getLocalStorageHash(n,i){return document.location.href+"."+i}function addPresetOption(n,i,o){var s=document.createElement("option");s.innerHTML=i,s.value=i,n.__preset_select.appendChild(s),o&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function showHideExplain(n,i){i.style.display=n.useLocalStorage?"block":"none"}function setWidth(n,i){n.domElement.style.width=i+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=i+"px"),n.__closeButton&&(n.__closeButton.style.width=i+"px")}function getCurrentPreset(n,i){var o={};return l.each(n.__rememberedObjects,function(s,a){var c={},u=n.__rememberedObjectIndecesToControllers[a];l.each(u,function(n,o){c[o]=i?n.initialValue:n.getValue()}),o[a]=c}),o}GUI.toggleHide=function(){I=!I,l.each(H,function(n){n.domElement.style.display=I?"none":""})},GUI.CLASS_AUTO_PLACE="a",GUI.CLASS_AUTO_PLACE_CONTAINER="ac",GUI.CLASS_MAIN="main",GUI.CLASS_CONTROLLER_ROW="cr",GUI.CLASS_TOO_TALL="taller-than-window",GUI.CLASS_CLOSED="closed",GUI.CLASS_CLOSE_BUTTON="close-button",GUI.CLASS_CLOSE_TOP="close-top",GUI.CLASS_CLOSE_BOTTOM="close-bottom",GUI.CLASS_DRAG="drag",GUI.DEFAULT_WIDTH=245,GUI.TEXT_CLOSED="Close Controls",GUI.TEXT_OPEN="Open Controls",GUI._keydownHandler=function(n){"text"!==document.activeElement.type&&(72===n.which||72===n.keyCode)&&GUI.toggleHide()},y.bind(window,"keydown",GUI._keydownHandler,!1),l.extend(GUI.prototype,{add:function(n,i){return _add(this,n,i,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(n,i){return _add(this,n,i,{color:!0})},remove:function(n){this.__ul.removeChild(n.__li),this.__controllers.splice(this.__controllers.indexOf(n),1);var i=this;l.defer(function(){i.onResize()})},destroy:function(){if(this.parent)throw Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&N.removeChild(this.domElement);var n=this;l.each(this.__folders,function(i){n.removeFolder(i)}),y.unbind(window,"keydown",GUI._keydownHandler,!1),removeListeners(this)},addFolder:function(n){if(void 0!==this.__folders[n])throw Error('You already have a folder in this GUI by the name "'+n+'"');var i={name:n,parent:this};i.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[n]&&(i.closed=this.load.folders[n].closed,i.load=this.load.folders[n]);var o=new GUI(i);this.__folders[n]=o;var s=addRow(this,o.domElement);return y.addClass(s,"folder"),o},removeFolder:function(n){this.__ul.removeChild(n.domElement.parentElement),delete this.__folders[n.name],this.load&&this.load.folders&&this.load.folders[n.name]&&delete this.load.folders[n.name],removeListeners(n);var i=this;l.each(n.__folders,function(i){n.removeFolder(i)}),l.defer(function(){i.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var n=this.getRoot();if(n.scrollable){var i=y.getOffset(n.__ul).top,o=0;l.each(n.__ul.childNodes,function(i){n.autoPlace&&i===n.__save_row||(o+=y.getHeight(i))}),window.innerHeight-i-20<o?(y.addClass(n.domElement,GUI.CLASS_TOO_TALL),n.__ul.style.height=window.innerHeight-i-20+"px"):(y.removeClass(n.domElement,GUI.CLASS_TOO_TALL),n.__ul.style.height="auto")}n.__resize_handle&&l.defer(function(){n.__resize_handle.style.height=n.__ul.offsetHeight+"px"}),n.__closeButton&&(n.__closeButton.style.width=n.width+"px")},onResizeDebounced:l.debounce(function(){this.onResize()},50),remember:function(){if(l.isUndefined(B)&&((B=new O).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw Error("You can only call remember on a top level GUI.");var n=this;l.each(Array.prototype.slice.call(arguments),function(i){0===n.__rememberedObjects.length&&function(n){var i=n.__save_row=document.createElement("li");y.addClass(n.domElement,"has-save"),n.__ul.insertBefore(i,n.__ul.firstChild),y.addClass(i,"save-row");var o=document.createElement("span");o.innerHTML="&nbsp;",y.addClass(o,"button gears");var s=document.createElement("span");s.innerHTML="Save",y.addClass(s,"button"),y.addClass(s,"save");var a=document.createElement("span");a.innerHTML="New",y.addClass(a,"button"),y.addClass(a,"save-as");var c=document.createElement("span");c.innerHTML="Revert",y.addClass(c,"button"),y.addClass(c,"revert");var u=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?l.each(n.load.remembered,function(i,o){addPresetOption(n,o,o===n.preset)}):addPresetOption(n,R,!1),y.bind(u,"change",function(){for(var i=0;i<n.__preset_select.length;i++)n.__preset_select[i].innerHTML=n.__preset_select[i].value;n.preset=this.value}),i.appendChild(u),i.appendChild(o),i.appendChild(s),i.appendChild(a),i.appendChild(c),P){var d=document.getElementById("dg-local-explain"),h=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(getLocalStorageHash(n,"isLocal"))&&h.setAttribute("checked","checked"),showHideExplain(n,d),y.bind(h,"change",function(){n.useLocalStorage=!n.useLocalStorage,showHideExplain(n,d)})}var f=document.getElementById("dg-new-constructor");y.bind(f,"keydown",function(n){n.metaKey&&(67===n.which||67===n.keyCode)&&B.hide()}),y.bind(o,"click",function(){f.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),B.show(),f.focus(),f.select()}),y.bind(s,"click",function(){n.save()}),y.bind(a,"click",function(){var i=prompt("Enter a new preset name.");i&&n.saveAs(i)}),y.bind(c,"click",function(){n.revert()})}(n),-1===n.__rememberedObjects.indexOf(i)&&n.__rememberedObjects.push(i)}),this.autoPlace&&setWidth(this,this.width)},getRoot:function(){for(var n=this;n.parent;)n=n.parent;return n},getSaveObject:function(){var n=this.load;return n.closed=this.closed,this.__rememberedObjects.length>0&&(n.preset=this.preset,n.remembered||(n.remembered={}),n.remembered[this.preset]=getCurrentPreset(this)),n.folders={},l.each(this.__folders,function(i,o){n.folders[o]=i.getSaveObject()}),n},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=getCurrentPreset(this),markPresetModified(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(n){this.load.remembered||(this.load.remembered={},this.load.remembered[R]=getCurrentPreset(this,!0)),this.load.remembered[n]=getCurrentPreset(this),this.preset=n,addPresetOption(this,n,!0),this.saveToLocalStorageIfPossible()},revert:function(n){l.each(this.__controllers,function(i){this.getRoot().load.remembered?recallSavedValue(n||this.getRoot(),i):i.setValue(i.initialValue),i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())},this),l.each(this.__folders,function(n){n.revert(n)}),n||markPresetModified(this.getRoot(),!1)},listen:function(n){var i=0===this.__listening.length;this.__listening.push(n),i&&function updateDisplays(n){0!==n.length&&L.call(window,function(){updateDisplays(n)}),l.each(n,function(n){n.updateDisplay()})}(this.__listening)},updateDisplay:function(){l.each(this.__controllers,function(n){n.updateDisplay()}),l.each(this.__folders,function(n){n.updateDisplay()})}});var U={Color:_,math:f,interpret:interpret},V={Controller:v,BooleanController:x,OptionController:w,StringController:C,NumberController:M,NumberControllerBox:E,NumberControllerSlider:S,FunctionController:k,ColorController:A},F={dom:y},G={GUI:GUI},z=GUI;i.default={color:U,controllers:V,dom:F,gui:G,GUI:z}},4173:function(n,i,o){"use strict";n.exports=function(n,i,o){switch(arguments.length){case 0:return new FilteredVector([0],[0],0);case 1:if("number"!=typeof n)return new FilteredVector(n,getZero(n.length),0);var s=getZero(n);return new FilteredVector(s,s,0);case 2:if("number"==typeof i){var s=getZero(n.length);return new FilteredVector(n,s,+i)}o=0;case 3:if(n.length!==i.length)throw Error("state and velocity lengths must match");return new FilteredVector(n,i,o)}};var s=o(617),a=o(3076);function clamp(n,i,o){return Math.min(i,Math.max(n,o))}function FilteredVector(n,i,o){this.dimension=n.length,this.bounds=[Array(this.dimension),Array(this.dimension)];for(var s=0;s<this.dimension;++s)this.bounds[0][s]=-1/0,this.bounds[1][s]=1/0;this._state=n.slice().reverse(),this._velocity=i.slice().reverse(),this._time=[o],this._scratch=[n.slice(),n.slice(),n.slice(),n.slice(),n.slice()]}var l=FilteredVector.prototype;function getZero(n){for(var i=Array(n),o=0;o<n;++o)i[o]=0;return i}l.flush=function(n){var i=a.gt(this._time,n)-1;i<=0||(this._time.splice(0,i),this._state.splice(0,i*this.dimension),this._velocity.splice(0,i*this.dimension))},l.curve=function(n){var i=this._time,o=i.length,l=a.le(i,n),c=this._scratch[0],u=this._state,d=this._velocity,h=this.dimension,f=this.bounds;if(l<0)for(var p=h-1,m=0;m<h;++m,--p)c[m]=u[p];else if(l>=o-1)for(var p=u.length-1,_=n-i[o-1],m=0;m<h;++m,--p)c[m]=u[p]+_*d[p];else{for(var p=h*(l+1)-1,v=i[l],g=i[l+1]-v||1,b=this._scratch[1],y=this._scratch[2],x=this._scratch[3],w=this._scratch[4],C=!0,m=0;m<h;++m,--p)b[m]=u[p],x[m]=d[p]*g,y[m]=u[p+h],w[m]=d[p+h]*g,C=C&&b[m]===y[m]&&x[m]===w[m]&&0===x[m];if(C)for(var m=0;m<h;++m)c[m]=b[m];else s(b,x,y,w,(n-v)/g,c)}for(var M=f[0],E=f[1],m=0;m<h;++m)c[m]=clamp(M[m],E[m],c[m]);return c},l.dcurve=function(n){var i=this._time,o=i.length,l=a.le(i,n),c=this._scratch[0],u=this._state,d=this._velocity,h=this.dimension;if(l>=o-1){var f=u.length-1;i[o-1];for(var p=0;p<h;++p,--f)c[p]=d[f]}else{for(var f=h*(l+1)-1,m=i[l],_=i[l+1]-m||1,v=this._scratch[1],g=this._scratch[2],b=this._scratch[3],y=this._scratch[4],x=!0,p=0;p<h;++p,--f)v[p]=u[f],b[p]=d[f]*_,g[p]=u[f+h],y[p]=d[f+h]*_,x=x&&v[p]===g[p]&&b[p]===y[p]&&0===b[p];if(x)for(var p=0;p<h;++p)c[p]=0;else{s.derivative(v,b,g,y,(n-m)/_,c);for(var p=0;p<h;++p)c[p]/=_}}return c},l.lastT=function(){var n=this._time;return n[n.length-1]},l.stable=function(){for(var n=this._velocity,i=n.length,o=this.dimension-1;o>=0;--o)if(n[--i])return!1;return!0},l.jump=function(n){var i=this.lastT(),o=this.dimension;if(!(n<i)&&arguments.length===o+1){var s=this._state,a=this._velocity,l=s.length-this.dimension,c=this.bounds,u=c[0],d=c[1];this._time.push(i,n);for(var h=0;h<2;++h)for(var f=0;f<o;++f)s.push(s[l++]),a.push(0);this._time.push(n);for(var f=o;f>0;--f)s.push(clamp(u[f-1],d[f-1],arguments[f])),a.push(0)}},l.push=function(n){var i=this.lastT(),o=this.dimension;if(!(n<i)&&arguments.length===o+1){var s=this._state,a=this._velocity,l=s.length-this.dimension,c=n-i,u=this.bounds,d=u[0],h=u[1],f=c>1e-6?1/c:0;this._time.push(n);for(var p=o;p>0;--p){var m=clamp(d[p-1],h[p-1],arguments[p]);s.push(m),a.push((m-s[l++])*f)}}},l.set=function(n){var i=this.dimension;if(!(n<this.lastT())&&arguments.length===i+1){var o=this._state,s=this._velocity,a=this.bounds,l=a[0],c=a[1];this._time.push(n);for(var u=i;u>0;--u)o.push(clamp(l[u-1],c[u-1],arguments[u])),s.push(0)}},l.move=function(n){var i=this.lastT(),o=this.dimension;if(!(n<=i)&&arguments.length===o+1){var s=this._state,a=this._velocity,l=s.length-this.dimension,c=this.bounds,u=c[0],d=c[1],h=n-i,f=h>1e-6?1/h:0;this._time.push(n);for(var p=o;p>0;--p){var m=arguments[p];s.push(clamp(u[p-1],d[p-1],s[l++]+m)),a.push(m*f)}}},l.idle=function(n){var i=this.lastT();if(!(n<i)){var o=this.dimension,s=this._state,a=this._velocity,l=s.length-o,c=this.bounds,u=c[0],d=c[1],h=n-i;this._time.push(n);for(var f=o-1;f>=0;--f)s.push(clamp(u[f],d[f],s[l]+h*a[l])),a.push(0),l+=1}}},8447:function(n){n.exports=function(n){var i=new Float32Array(16);return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i}},6252:function(n){n.exports=function(){var n=new Float32Array(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}},7919:function(n){n.exports=function(n){var i=n[0],o=n[1],s=n[2],a=n[3],l=n[4],c=n[5],u=n[6],d=n[7],h=n[8],f=n[9],p=n[10],m=n[11],_=n[12],v=n[13],g=n[14],b=n[15];return(i*c-o*l)*(p*b-m*g)-(i*u-s*l)*(f*b-m*v)+(i*d-a*l)*(f*g-p*v)+(o*u-s*c)*(h*b-m*_)-(o*d-a*c)*(h*g-p*_)+(s*d-a*u)*(h*v-f*_)}},7127:function(n){n.exports=function(n,i){var o=i[0],s=i[1],a=i[2],l=i[3],c=o+o,u=s+s,d=a+a,h=o*c,f=s*c,p=s*u,m=a*c,_=a*u,v=a*d,g=l*c,b=l*u,y=l*d;return n[0]=1-p-v,n[1]=f+y,n[2]=m-b,n[3]=0,n[4]=f-y,n[5]=1-h-v,n[6]=_+g,n[7]=0,n[8]=m+b,n[9]=_-g,n[10]=1-h-p,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}},1872:function(n){n.exports=function(n,i,o){var s=i[0],a=i[1],l=i[2],c=i[3],u=s+s,d=a+a,h=l+l,f=s*u,p=s*d,m=s*h,_=a*d,v=a*h,g=l*h,b=c*u,y=c*d,x=c*h;return n[0]=1-(_+g),n[1]=p+x,n[2]=m-y,n[3]=0,n[4]=p-x,n[5]=1-(f+g),n[6]=v+b,n[7]=0,n[8]=m+y,n[9]=v-b,n[10]=1-(f+_),n[11]=0,n[12]=o[0],n[13]=o[1],n[14]=o[2],n[15]=1,n}},6312:function(n){n.exports=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}},4481:function(n){n.exports=function(n,i){var o=i[0],s=i[1],a=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],f=i[8],p=i[9],m=i[10],_=i[11],v=i[12],g=i[13],b=i[14],y=i[15],x=o*u-s*c,w=o*d-a*c,C=o*h-l*c,M=s*d-a*u,E=s*h-l*u,S=a*h-l*d,k=f*g-p*v,A=f*b-m*v,T=f*y-_*v,L=p*b-m*g,O=p*y-_*g,R=m*y-_*b,P=x*R-w*O+C*L+M*T-E*A+S*k;return P?(P=1/P,n[0]=(u*R-d*O+h*L)*P,n[1]=(a*O-s*R-l*L)*P,n[2]=(g*S-b*E+y*M)*P,n[3]=(m*E-p*S-_*M)*P,n[4]=(d*T-c*R-h*A)*P,n[5]=(o*R-a*T+l*A)*P,n[6]=(b*C-v*S-y*w)*P,n[7]=(f*S-m*C+_*w)*P,n[8]=(c*O-u*T+h*k)*P,n[9]=(s*T-o*O-l*k)*P,n[10]=(v*E-g*C+y*x)*P,n[11]=(p*C-f*E-_*x)*P,n[12]=(u*A-c*L-d*k)*P,n[13]=(o*L-s*A+a*k)*P,n[14]=(g*w-v*M-b*x)*P,n[15]=(f*M-p*w+m*x)*P,n):null}},4727:function(n,i,o){var s=o(6312);n.exports=function(n,i,o,a){var l,c,u,d,h,f,p,m,_,v,g=i[0],b=i[1],y=i[2],x=a[0],w=a[1],C=a[2],M=o[0],E=o[1],S=o[2];return 1e-6>Math.abs(g-M)&&1e-6>Math.abs(b-E)&&1e-6>Math.abs(y-S)?s(n):(v=1/Math.sqrt((p=g-M)*p+(m=b-E)*m+(_=y-S)*_),p*=v,m*=v,_*=v,(v=Math.sqrt((l=w*_-C*m)*l+(c=C*p-x*_)*c+(u=x*m-w*p)*u))?(l*=v=1/v,c*=v,u*=v):(l=0,c=0,u=0),(v=Math.sqrt((d=m*u-_*c)*d+(h=_*l-p*u)*h+(f=p*c-m*l)*f))?(d*=v=1/v,h*=v,f*=v):(d=0,h=0,f=0),n[0]=l,n[1]=d,n[2]=p,n[3]=0,n[4]=c,n[5]=h,n[6]=m,n[7]=0,n[8]=u,n[9]=f,n[10]=_,n[11]=0,n[12]=-(l*g+c*b+u*y),n[13]=-(d*g+h*b+f*y),n[14]=-(p*g+m*b+_*y),n[15]=1,n)}},9401:function(n){n.exports=function(n,i,o){var s=i[0],a=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],f=i[7],p=i[8],m=i[9],_=i[10],v=i[11],g=i[12],b=i[13],y=i[14],x=i[15],w=o[0],C=o[1],M=o[2],E=o[3];return n[0]=w*s+C*u+M*p+E*g,n[1]=w*a+C*d+M*m+E*b,n[2]=w*l+C*h+M*_+E*y,n[3]=w*c+C*f+M*v+E*x,w=o[4],C=o[5],M=o[6],E=o[7],n[4]=w*s+C*u+M*p+E*g,n[5]=w*a+C*d+M*m+E*b,n[6]=w*l+C*h+M*_+E*y,n[7]=w*c+C*f+M*v+E*x,w=o[8],C=o[9],M=o[10],E=o[11],n[8]=w*s+C*u+M*p+E*g,n[9]=w*a+C*d+M*m+E*b,n[10]=w*l+C*h+M*_+E*y,n[11]=w*c+C*f+M*v+E*x,w=o[12],C=o[13],M=o[14],E=o[15],n[12]=w*s+C*u+M*p+E*g,n[13]=w*a+C*d+M*m+E*b,n[14]=w*l+C*h+M*_+E*y,n[15]=w*c+C*f+M*v+E*x,n}},397:function(n){n.exports=function(n,i,o,s){var a,l,c,u,d,h,f,p,m,_,v,g,b,y,x,w,C,M,E,S,k,A,T,L,O=s[0],R=s[1],P=s[2],B=Math.sqrt(O*O+R*R+P*P);return 1e-6>Math.abs(B)?null:(O*=B=1/B,R*=B,P*=B,a=Math.sin(o),c=1-(l=Math.cos(o)),u=i[0],d=i[1],h=i[2],f=i[3],p=i[4],m=i[5],_=i[6],v=i[7],g=i[8],b=i[9],y=i[10],x=i[11],w=O*O*c+l,C=R*O*c+P*a,M=P*O*c-R*a,E=O*R*c-P*a,S=R*R*c+l,k=P*R*c+O*a,A=O*P*c+R*a,T=R*P*c-O*a,L=P*P*c+l,n[0]=u*w+p*C+g*M,n[1]=d*w+m*C+b*M,n[2]=h*w+_*C+y*M,n[3]=f*w+v*C+x*M,n[4]=u*E+p*S+g*k,n[5]=d*E+m*S+b*k,n[6]=h*E+_*S+y*k,n[7]=f*E+v*S+x*k,n[8]=u*A+p*T+g*L,n[9]=d*A+m*T+b*L,n[10]=h*A+_*T+y*L,n[11]=f*A+v*T+x*L,i!==n&&(n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15]),n)}},4663:function(n){n.exports=function(n,i,o){var s=Math.sin(o),a=Math.cos(o),l=i[4],c=i[5],u=i[6],d=i[7],h=i[8],f=i[9],p=i[10],m=i[11];return i!==n&&(n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15]),n[4]=l*a+h*s,n[5]=c*a+f*s,n[6]=u*a+p*s,n[7]=d*a+m*s,n[8]=h*a-l*s,n[9]=f*a-c*s,n[10]=p*a-u*s,n[11]=m*a-d*s,n}},2113:function(n){n.exports=function(n,i,o){var s=Math.sin(o),a=Math.cos(o),l=i[0],c=i[1],u=i[2],d=i[3],h=i[8],f=i[9],p=i[10],m=i[11];return i!==n&&(n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15]),n[0]=l*a-h*s,n[1]=c*a-f*s,n[2]=u*a-p*s,n[3]=d*a-m*s,n[8]=l*s+h*a,n[9]=c*s+f*a,n[10]=u*s+p*a,n[11]=d*s+m*a,n}},974:function(n){n.exports=function(n,i,o){var s=Math.sin(o),a=Math.cos(o),l=i[0],c=i[1],u=i[2],d=i[3],h=i[4],f=i[5],p=i[6],m=i[7];return i!==n&&(n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15]),n[0]=l*a+h*s,n[1]=c*a+f*s,n[2]=u*a+p*s,n[3]=d*a+m*s,n[4]=h*a-l*s,n[5]=f*a-c*s,n[6]=p*a-u*s,n[7]=m*a-d*s,n}},4028:function(n){n.exports=function(n,i,o){var s=o[0],a=o[1],l=o[2];return n[0]=i[0]*s,n[1]=i[1]*s,n[2]=i[2]*s,n[3]=i[3]*s,n[4]=i[4]*a,n[5]=i[5]*a,n[6]=i[6]*a,n[7]=i[7]*a,n[8]=i[8]*l,n[9]=i[9]*l,n[10]=i[10]*l,n[11]=i[11]*l,n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n}},2602:function(n){n.exports=function(n,i,o){var s,a,l,c,u,d,h,f,p,m,_,v,g=o[0],b=o[1],y=o[2];return i===n?(n[12]=i[0]*g+i[4]*b+i[8]*y+i[12],n[13]=i[1]*g+i[5]*b+i[9]*y+i[13],n[14]=i[2]*g+i[6]*b+i[10]*y+i[14],n[15]=i[3]*g+i[7]*b+i[11]*y+i[15]):(s=i[0],a=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],f=i[7],p=i[8],m=i[9],_=i[10],v=i[11],n[0]=s,n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=d,n[6]=h,n[7]=f,n[8]=p,n[9]=m,n[10]=_,n[11]=v,n[12]=s*g+u*b+p*y+i[12],n[13]=a*g+d*b+m*y+i[13],n[14]=l*g+h*b+_*y+i[14],n[15]=c*g+f*b+v*y+i[15]),n}},9683:function(n){n.exports=function(n,i){if(n===i){var o=i[1],s=i[2],a=i[3],l=i[6],c=i[7],u=i[11];n[1]=i[4],n[2]=i[8],n[3]=i[12],n[4]=o,n[6]=i[9],n[7]=i[13],n[8]=s,n[9]=l,n[11]=i[14],n[12]=a,n[13]=c,n[14]=u}else n[0]=i[0],n[1]=i[4],n[2]=i[8],n[3]=i[12],n[4]=i[1],n[5]=i[5],n[6]=i[9],n[7]=i[13],n[8]=i[2],n[9]=i[6],n[10]=i[10],n[11]=i[14],n[12]=i[3],n[13]=i[7],n[14]=i[11],n[15]=i[15];return n}},4600:function(n){n.exports=function(n,i,o,s){var a,l,c,u,d,h=i[0],f=i[1],p=i[2],m=i[3],_=o[0],v=o[1],g=o[2],b=o[3];return(l=h*_+f*v+p*g+m*b)<0&&(l=-l,_=-_,v=-v,g=-g,b=-b),1-l>1e-6?(c=Math.sin(a=Math.acos(l)),u=Math.sin((1-s)*a)/c,d=Math.sin(s*a)/c):(u=1-s,d=s),n[0]=u*h+d*_,n[1]=u*f+d*v,n[2]=u*p+d*g,n[3]=u*m+d*b,n}},3858:function(n){n.exports=function(n,i,o){var s=i[0],a=i[1],l=i[2],c=o[0],u=o[1],d=o[2];return n[0]=a*d-l*u,n[1]=l*c-s*d,n[2]=s*u-a*c,n}},8368:function(n){n.exports=function(n,i){return n[0]*i[0]+n[1]*i[1]+n[2]*i[2]}},7563:function(n){n.exports=function(n){var i=n[0],o=n[1],s=n[2];return Math.sqrt(i*i+o*o+s*s)}},6919:function(n){n.exports=function(n,i,o,s){var a=i[0],l=i[1],c=i[2];return n[0]=a+s*(o[0]-a),n[1]=l+s*(o[1]-l),n[2]=c+s*(o[2]-c),n}},91:function(n){n.exports=function(n,i){var o=i[0],s=i[1],a=i[2],l=o*o+s*s+a*a;return l>0&&(l=1/Math.sqrt(l),n[0]=i[0]*l,n[1]=i[1]*l,n[2]=i[2]*l),n}},6795:function(n,i,o){"use strict";var s=o(8033);n.exports=s&&function(){var n=!1;try{var i=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,i),window.removeEventListener("test",null,i)}catch(i){n=!1}return n}()},8033:function(n){n.exports=!0},9805:function(n,i,o){var s=o(9604),a=o(6252),l=o(8447),c=o(7919),u=o(4481),d=o(9683),h={length:o(7563),normalize:o(91),dot:o(8368),cross:o(3858)},f=a(),p=a(),m=[0,0,0,0],_=[[0,0,0],[0,0,0],[0,0,0]],v=[0,0,0];function combine(n,i,o,s,a){n[0]=i[0]*s+o[0]*a,n[1]=i[1]*s+o[1]*a,n[2]=i[2]*s+o[2]*a}n.exports=function(n,i,o,a,g,b){if(i||(i=[0,0,0]),o||(o=[0,0,0]),a||(a=[0,0,0]),g||(g=[0,0,0,1]),b||(b=[0,0,0,1]),!s(f,n)||(l(p,f),p[3]=0,p[7]=0,p[11]=0,p[15]=1,Math.abs(1e-8>c(p))))return!1;var y,x,w,C,M,E=f[3],S=f[7],k=f[11],A=f[12],T=f[13],L=f[14],O=f[15];if(0!==E||0!==S||0!==k){if(m[0]=E,m[1]=S,m[2]=k,m[3]=O,!u(p,p))return!1;d(p,p),y=g,x=m[0],w=m[1],C=m[2],M=m[3],y[0]=p[0]*x+p[4]*w+p[8]*C+p[12]*M,y[1]=p[1]*x+p[5]*w+p[9]*C+p[13]*M,y[2]=p[2]*x+p[6]*w+p[10]*C+p[14]*M,y[3]=p[3]*x+p[7]*w+p[11]*C+p[15]*M}else g[0]=g[1]=g[2]=0,g[3]=1;if(i[0]=A,i[1]=T,i[2]=L,_[0][0]=f[0],_[0][1]=f[1],_[0][2]=f[2],_[1][0]=f[4],_[1][1]=f[5],_[1][2]=f[6],_[2][0]=f[8],_[2][1]=f[9],_[2][2]=f[10],o[0]=h.length(_[0]),h.normalize(_[0],_[0]),a[0]=h.dot(_[0],_[1]),combine(_[1],_[1],_[0],1,-a[0]),o[1]=h.length(_[1]),h.normalize(_[1],_[1]),a[0]/=o[1],a[1]=h.dot(_[0],_[2]),combine(_[2],_[2],_[0],1,-a[1]),a[2]=h.dot(_[1],_[2]),combine(_[2],_[2],_[1],1,-a[2]),o[2]=h.length(_[2]),h.normalize(_[2],_[2]),a[1]/=o[2],a[2]/=o[2],h.cross(v,_[1],_[2]),0>h.dot(_[0],v))for(var R=0;R<3;R++)o[R]*=-1,_[R][0]*=-1,_[R][1]*=-1,_[R][2]*=-1;return b[0]=.5*Math.sqrt(Math.max(1+_[0][0]-_[1][1]-_[2][2],0)),b[1]=.5*Math.sqrt(Math.max(1-_[0][0]+_[1][1]-_[2][2],0)),b[2]=.5*Math.sqrt(Math.max(1-_[0][0]-_[1][1]+_[2][2],0)),b[3]=.5*Math.sqrt(Math.max(1+_[0][0]+_[1][1]+_[2][2],0)),_[2][1]>_[1][2]&&(b[0]=-b[0]),_[0][2]>_[2][0]&&(b[1]=-b[1]),_[1][0]>_[0][1]&&(b[2]=-b[2]),!0}},9604:function(n){n.exports=function(n,i){var o=i[15];if(0===o)return!1;for(var s=1/o,a=0;a<16;a++)n[a]=i[a]*s;return!0}},2726:function(n,i,o){var s=o(6919),a=o(7814),l=o(9805),c=o(7919),u=o(2210),d=state(),h=state(),f=state();function state(){return{translate:vec3(),scale:vec3(1),skew:vec3(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function vec3(n){return[n||0,n||0,n||0]}n.exports=function(n,i,o,p){if(0===c(i)||0===c(o))return!1;var m=l(i,d.translate,d.scale,d.skew,d.perspective,d.quaternion),_=l(o,h.translate,h.scale,h.skew,h.perspective,h.quaternion);return!!m&&!!_&&(s(f.translate,d.translate,h.translate,p),s(f.skew,d.skew,h.skew,p),s(f.scale,d.scale,h.scale,p),s(f.perspective,d.perspective,h.perspective,p),u(f.quaternion,d.quaternion,h.quaternion,p),a(n,f.translate,f.scale,f.skew,f.perspective,f.quaternion),!0)}},7814:function(n,i,o){var s={identity:o(6312),translate:o(2602),multiply:o(9401),create:o(6252),scale:o(4028),fromRotationTranslation:o(1872)};s.create();var a=s.create();n.exports=function(n,i,o,l,c,u){return s.identity(n),s.fromRotationTranslation(n,u,i),n[3]=c[0],n[7]=c[1],n[11]=c[2],n[15]=c[3],s.identity(a),0!==l[2]&&(a[9]=l[2],s.multiply(n,n,a)),0!==l[1]&&(a[9]=0,a[8]=l[1],s.multiply(n,n,a)),0!==l[0]&&(a[8]=0,a[4]=l[0],s.multiply(n,n,a)),s.scale(n,n,o),n}},7622:function(n,i,o){"use strict";var s=o(3076),a=o(2726),l=o(4481),c=o(4663),u=o(2113),d=o(974),h=o(4727),f=o(2602);o(4028);var p=o(91),m=[0,0,0];function MatrixCameraController(n){this._components=n.slice(),this._time=[0],this.prevMatrix=n.slice(),this.nextMatrix=n.slice(),this.computedMatrix=n.slice(),this.computedInverse=n.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}n.exports=function(n){var i=(n=n||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new MatrixCameraController(i)};var _=MatrixCameraController.prototype;_.recalcMatrix=function(n){var i=this._time,o=s.le(i,n),c=this.computedMatrix;if(!(o<0)){var u=this._components;if(o===i.length-1)for(var d=16*o,h=0;h<16;++h)c[h]=u[d++];else{for(var f=i[o+1]-i[o],d=16*o,m=this.prevMatrix,_=!0,h=0;h<16;++h)m[h]=u[d++];for(var v=this.nextMatrix,h=0;h<16;++h)v[h]=u[d++],_=_&&m[h]===v[h];if(f<1e-6||_)for(var h=0;h<16;++h)c[h]=m[h];else a(c,m,v,(n-i[o])/f)}var g=this.computedUp;g[0]=c[1],g[1]=c[5],g[2]=c[9],p(g,g);var b=this.computedInverse;l(b,c);var y=this.computedEye,x=b[15];y[0]=b[12]/x,y[1]=b[13]/x,y[2]=b[14]/x;for(var w=this.computedCenter,C=Math.exp(this.computedRadius[0]),h=0;h<3;++h)w[h]=y[h]-c[2+4*h]*C}},_.idle=function(n){if(!(n<this.lastT())){for(var i=this._components,o=i.length-16,s=0;s<16;++s)i.push(i[o++]);this._time.push(n)}},_.flush=function(n){var i=s.gt(this._time,n)-2;i<0||(this._time.splice(0,i),this._components.splice(0,16*i))},_.lastT=function(){return this._time[this._time.length-1]},_.lookAt=function(n,i,o,s){this.recalcMatrix(n),i=i||this.computedEye,o=o||m,s=s||this.computedUp,this.setMatrix(n,h(this.computedMatrix,i,o,s));for(var a=0,l=0;l<3;++l)a+=Math.pow(o[l]-i[l],2);a=Math.log(Math.sqrt(a)),this.computedRadius[0]=a},_.rotate=function(n,i,o,s){this.recalcMatrix(n);var a=this.computedInverse;i&&u(a,a,i),o&&c(a,a,o),s&&d(a,a,s),this.setMatrix(n,l(this.computedMatrix,a))};var v=[0,0,0];_.pan=function(n,i,o,s){v[0]=-(i||0),v[1]=-(o||0),v[2]=-(s||0),this.recalcMatrix(n);var a=this.computedInverse;f(a,a,v),this.setMatrix(n,l(a,a))},_.translate=function(n,i,o,s){v[0]=i||0,v[1]=o||0,v[2]=s||0,this.recalcMatrix(n);var a=this.computedMatrix;f(a,a,v),this.setMatrix(n,a)},_.setMatrix=function(n,i){if(!(n<this.lastT())){this._time.push(n);for(var o=0;o<16;++o)this._components.push(i[o])}},_.setDistance=function(n,i){this.computedRadius[0]=i},_.setDistanceLimits=function(n,i){var o=this._limits;o[0]=n,o[1]=i},_.getDistanceLimits=function(n){var i=this._limits;return n?(n[0]=i[0],n[1]=i[1],n):i}},685:function(n,i,o){"use strict";n.exports=function(n,i){i||(i=n,n=window);var o=0,a=0,l=0,c={shift:!1,alt:!1,control:!1,meta:!1},u=!1;function updateMods(n){var i=!1;return"altKey"in n&&(i=i||n.altKey!==c.alt,c.alt=!!n.altKey),"shiftKey"in n&&(i=i||n.shiftKey!==c.shift,c.shift=!!n.shiftKey),"ctrlKey"in n&&(i=i||n.ctrlKey!==c.control,c.control=!!n.ctrlKey),"metaKey"in n&&(i=i||n.metaKey!==c.meta,c.meta=!!n.metaKey),i}function handleEvent(n,u){var d=s.x(u),h=s.y(u);"buttons"in u&&(n=0|u.buttons),(n!==o||d!==a||h!==l||updateMods(u))&&(o=0|n,a=d||0,l=h||0,i&&i(o,a,l,c))}function clearState(n){handleEvent(0,n)}function handleBlur(){(o||a||l||c.shift||c.alt||c.meta||c.control)&&(a=l=0,o=0,c.shift=c.alt=c.control=c.meta=!1,i&&i(0,0,0,c))}function handleMods(n){updateMods(n)&&i&&i(o,a,l,c)}function handleMouseMove(n){0===s.buttons(n)?handleEvent(0,n):handleEvent(o,n)}function handleMouseDown(n){handleEvent(o|s.buttons(n),n)}function handleMouseUp(n){handleEvent(o&~s.buttons(n),n)}function attachListeners(){u||(u=!0,n.addEventListener("mousemove",handleMouseMove),n.addEventListener("mousedown",handleMouseDown),n.addEventListener("mouseup",handleMouseUp),n.addEventListener("mouseleave",clearState),n.addEventListener("mouseenter",clearState),n.addEventListener("mouseout",clearState),n.addEventListener("mouseover",clearState),n.addEventListener("blur",handleBlur),n.addEventListener("keyup",handleMods),n.addEventListener("keydown",handleMods),n.addEventListener("keypress",handleMods),n!==window&&(window.addEventListener("blur",handleBlur),window.addEventListener("keyup",handleMods),window.addEventListener("keydown",handleMods),window.addEventListener("keypress",handleMods)))}attachListeners();var d={element:n};return Object.defineProperties(d,{enabled:{get:function(){return u},set:function(i){i?attachListeners():u&&(u=!1,n.removeEventListener("mousemove",handleMouseMove),n.removeEventListener("mousedown",handleMouseDown),n.removeEventListener("mouseup",handleMouseUp),n.removeEventListener("mouseleave",clearState),n.removeEventListener("mouseenter",clearState),n.removeEventListener("mouseout",clearState),n.removeEventListener("mouseover",clearState),n.removeEventListener("blur",handleBlur),n.removeEventListener("keyup",handleMods),n.removeEventListener("keydown",handleMods),n.removeEventListener("keypress",handleMods),n!==window&&(window.removeEventListener("blur",handleBlur),window.removeEventListener("keyup",handleMods),window.removeEventListener("keydown",handleMods),window.removeEventListener("keypress",handleMods)))},enumerable:!0},buttons:{get:function(){return o},enumerable:!0},x:{get:function(){return a},enumerable:!0},y:{get:function(){return l},enumerable:!0},mods:{get:function(){return c},enumerable:!0}}),d};var s=o(9294)},675:function(n){var i={left:0,top:0};n.exports=function(n,o,s){o=o||n.currentTarget||n.srcElement,Array.isArray(s)||(s=[0,0]);var a,l=n.clientX||0,c=n.clientY||0,u=(a=o)===window||a===document||a===document.body?i:a.getBoundingClientRect();return s[0]=l-u.left,s[1]=c-u.top,s}},9294:function(n,i){"use strict";function mouseElement(n){return n.target||n.srcElement||window}i.buttons=function(n){if("object"==typeof n){if("buttons"in n)return n.buttons;if("which"in n){var i=n.which;if(2===i)return 4;if(3===i)return 2;if(i>0)return 1<<i-1}else if("button"in n){var i=n.button;if(1===i)return 4;if(2===i)return 2;if(i>=0)return 1<<i}}return 0},i.element=mouseElement,i.x=function(n){if("object"==typeof n){if("offsetX"in n)return n.offsetX;var i=mouseElement(n).getBoundingClientRect();return n.clientX-i.left}return 0},i.y=function(n){if("object"==typeof n){if("offsetY"in n)return n.offsetY;var i=mouseElement(n).getBoundingClientRect();return n.clientY-i.top}return 0}},2232:function(n,i,o){"use strict";var s=o(9810);n.exports=function(n,i,o){"function"==typeof n&&(o=!!i,i=n,n=window);var a=s("ex",n),listener=function(n){o&&n.preventDefault();var s=n.deltaX||0,l=n.deltaY||0,c=n.deltaZ||0,u=n.deltaMode,d=1;switch(u){case 1:d=a;break;case 2:d=window.innerHeight}if(s*=d,l*=d,c*=d,s||l||c)return i(s,l,c,n)};return n.addEventListener("wheel",listener),listener}},8918:function(n){"use strict";n.exports=function(n,i,o,s,a,l,c,u,d,h){var f=i+l+h;if(p>0){var p=Math.sqrt(f+1);n[0]=.5*(c-d)/p,n[1]=.5*(u-s)/p,n[2]=.5*(o-l)/p,n[3]=.5*p}else{var m=Math.max(i,l,h),p=Math.sqrt(2*m-f+1);i>=m?(n[0]=.5*p,n[1]=.5*(a+o)/p,n[2]=.5*(u+s)/p,n[3]=.5*(c-d)/p):l>=m?(n[0]=.5*(o+a)/p,n[1]=.5*p,n[2]=.5*(d+c)/p,n[3]=.5*(u-s)/p):(n[0]=.5*(s+u)/p,n[1]=.5*(c+d)/p,n[2]=.5*p,n[3]=.5*(o-a)/p)}return n}},809:function(n,i,o){"use strict";n.exports=function(n){var i=(n=n||{}).center||[0,0,0],o=n.rotation||[0,0,0,1],s=n.radius||1;i=[].slice.call(i,0,3),normalize4(o=[].slice.call(o,0,4),o);var a=new OrbitCameraController(o,i,Math.log(s));return a.setDistanceLimits(n.zoomMin,n.zoomMax),("eye"in n||"up"in n)&&a.lookAt(0,n.eye,n.center,n.up),a};var s=o(4173),a=o(4727),l=o(7127),c=o(4481),u=o(8918);function len3(n,i,o){return Math.sqrt(Math.pow(n,2)+Math.pow(i,2)+Math.pow(o,2))}function len4(n,i,o,s){return Math.sqrt(Math.pow(n,2)+Math.pow(i,2)+Math.pow(o,2)+Math.pow(s,2))}function normalize4(n,i){var o=i[0],s=i[1],a=i[2],l=i[3],c=len4(o,s,a,l);c>1e-6?(n[0]=o/c,n[1]=s/c,n[2]=a/c,n[3]=l/c):(n[0]=n[1]=n[2]=0,n[3]=1)}function OrbitCameraController(n,i,o){this.radius=s([o]),this.center=s(i),this.rotation=s(n),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var d=OrbitCameraController.prototype;d.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},d.recalcMatrix=function(n){this.radius.curve(n),this.center.curve(n),this.rotation.curve(n);var i=this.computedRotation;normalize4(i,i);var o=this.computedMatrix;l(o,i);var s=this.computedCenter,a=this.computedEye,c=this.computedUp,u=Math.exp(this.computedRadius[0]);a[0]=s[0]+u*o[2],a[1]=s[1]+u*o[6],a[2]=s[2]+u*o[10],c[0]=o[1],c[1]=o[5],c[2]=o[9];for(var d=0;d<3;++d){for(var h=0,f=0;f<3;++f)h+=o[d+4*f]*a[f];o[12+d]=-h}},d.getMatrix=function(n,i){this.recalcMatrix(n);var o=this.computedMatrix;if(i){for(var s=0;s<16;++s)i[s]=o[s];return i}return o},d.idle=function(n){this.center.idle(n),this.radius.idle(n),this.rotation.idle(n)},d.flush=function(n){this.center.flush(n),this.radius.flush(n),this.rotation.flush(n)},d.pan=function(n,i,o,s){i=i||0,o=o||0,s=s||0,this.recalcMatrix(n);var a=this.computedMatrix,l=a[1],c=a[5],u=a[9],d=len3(l,c,u);l/=d,c/=d,u/=d;var h=a[0],f=a[4],p=a[8],m=h*l+f*c+p*u,_=len3(h-=l*m,f-=c*m,p-=u*m);h/=_,f/=_,p/=_;var v=a[2],g=a[6],b=a[10],y=v*l+g*c+b*u,x=v*h+g*f+b*p,w=len3(v-=y*l+x*h,g-=y*c+x*f,b-=y*u+x*p);v/=w,g/=w,b/=w;var C=h*i+l*o,M=f*i+c*o,E=p*i+u*o;this.center.move(n,C,M,E);var S=Math.exp(this.computedRadius[0]);S=Math.max(1e-4,S+s),this.radius.set(n,Math.log(S))},d.rotate=function(n,i,o,s){this.recalcMatrix(n),i=i||0,o=o||0;var a=this.computedMatrix,l=a[0],c=a[4],u=a[8],d=a[1],h=a[5],f=a[9],p=a[2],m=a[6],_=a[10],v=i*l+o*d,g=i*c+o*h,b=i*u+o*f,y=-(m*b-_*g),x=-(_*v-p*b),w=-(p*g-m*v),C=Math.sqrt(Math.max(0,1-Math.pow(y,2)-Math.pow(x,2)-Math.pow(w,2))),M=len4(y,x,w,C);M>1e-6?(y/=M,x/=M,w/=M,C/=M):(y=x=w=0,C=1);var E=this.computedRotation,S=E[0],k=E[1],A=E[2],T=E[3],L=S*C+T*y+k*w-A*x,O=k*C+T*x+A*y-S*w,R=A*C+T*w+S*x-k*y,P=T*C-S*y-k*x-A*w;if(s){var B=Math.sin(s)/len3(y=p,x=m,w=_);y*=B,x*=B,w*=B,L=L*(C=Math.cos(i))+P*y+O*w-R*x,O=O*C+P*x+R*y-L*w,R=R*C+P*w+L*x-O*y,P=P*C-L*y-O*x-R*w}var D=len4(L,O,R,P);D>1e-6?(L/=D,O/=D,R/=D,P/=D):(L=O=R=0,P=1),this.rotation.set(n,L,O,R,P)},d.lookAt=function(n,i,o,s){this.recalcMatrix(n),o=o||this.computedCenter,i=i||this.computedEye,s=s||this.computedUp;var l=this.computedMatrix;a(l,i,o,s);var c=this.computedRotation;u(c,l[0],l[1],l[2],l[4],l[5],l[6],l[8],l[9],l[10]),normalize4(c,c),this.rotation.set(n,c[0],c[1],c[2],c[3]);for(var d=0,h=0;h<3;++h)d+=Math.pow(o[h]-i[h],2);this.radius.set(n,.5*Math.log(Math.max(d,1e-6))),this.center.set(n,o[0],o[1],o[2])},d.translate=function(n,i,o,s){this.center.move(n,i||0,o||0,s||0)},d.setMatrix=function(n,i){var o=this.computedRotation;u(o,i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],i[10]),normalize4(o,o),this.rotation.set(n,o[0],o[1],o[2],o[3]);var s=this.computedMatrix;c(s,i);var a=s[15];if(Math.abs(a)>1e-6){var l=s[12]/a,d=s[13]/a,h=s[14]/a;this.recalcMatrix(n);var f=Math.exp(this.computedRadius[0]);this.center.set(n,l-s[2]*f,d-s[6]*f,h-s[10]*f),this.radius.idle(n)}else this.center.idle(n),this.radius.idle(n)},d.setDistance=function(n,i){i>0&&this.radius.set(n,Math.log(i))},d.setDistanceLimits=function(n,i){n=n>0?Math.log(n):-1/0,i=Math.max(i=i>0?Math.log(i):1/0,n),this.radius.bounds[0][0]=n,this.radius.bounds[1][0]=i},d.getDistanceLimits=function(n){var i=this.radius.bounds;return n?(n[0]=Math.exp(i[0][0]),n[1]=Math.exp(i[1][0]),n):[Math.exp(i[0][0]),Math.exp(i[1][0])]},d.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},d.fromJSON=function(n){var i=this.lastT(),o=n.center;o&&this.center.set(i,o[0],o[1],o[2]);var s=n.rotation;s&&this.rotation.set(i,s[0],s[1],s[2],s[3]);var a=n.distance;a&&a>0&&this.radius.set(i,Math.log(a)),this.setDistanceLimits(n.zoomMin,n.zoomMax)}},1885:function(n){n.exports=function(n,i){i||(i=[0,""]);var o=parseFloat(n=String(n),10);return i[0]=o,i[1]=n.match(/[\d.\-\+]*\s*(.*)/)[1]||"",i}},2210:function(n,i,o){n.exports=o(4600)},698:function(n,i,o){n.exports=o.g.performance&&o.g.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}},2792:function(n){var i;n.exports=((i=function(){var n=0,o=document.createElement("div");function e(n){return o.appendChild(n.dom),n}function t(i){for(var s=0;s<o.children.length;s++)o.children[s].style.display=s===i?"block":"none";n=i}o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(i){i.preventDefault(),t(++n%o.children.length)},!1);var s=(performance||Date).now(),a=s,l=0,c=e(new i.Panel("FPS","#0ff","#002")),u=e(new i.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=e(new i.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:o,addPanel:e,showPanel:t,begin:function(){s=(performance||Date).now()},end:function(){l++;var n=(performance||Date).now();if(u.update(n-s,200),a+1e3<=n&&(c.update(1e3*l/(n-a),100),a=n,l=0,d)){var i=performance.memory;d.update(i.usedJSHeapSize/1048576,i.jsHeapSizeLimit/1048576)}return n},update:function(){s=this.end()},domElement:o,setMode:t}}).Panel=function(n,i,o){var s=1/0,a=0,l=Math.round,c=l(window.devicePixelRatio||1),u=80*c,d=48*c,h=3*c,f=2*c,p=3*c,m=15*c,_=74*c,v=30*c,g=document.createElement("canvas");g.width=u,g.height=d,g.style.cssText="width:80px;height:48px";var b=g.getContext("2d");return b.font="bold "+9*c+"px Helvetica,Arial,sans-serif",b.textBaseline="top",b.fillStyle=o,b.fillRect(0,0,u,d),b.fillStyle=i,b.fillText(n,h,f),b.fillRect(p,m,_,v),b.fillStyle=o,b.globalAlpha=.9,b.fillRect(p,m,_,v),{dom:g,update:function(d,y){s=Math.min(s,d),a=Math.max(a,d),b.fillStyle=o,b.globalAlpha=1,b.fillRect(0,0,u,m),b.fillStyle=i,b.fillText(l(d)+" "+n+" ("+l(s)+"-"+l(a)+")",h,f),b.drawImage(g,p+c,m,_-c,v,p,m,_-c,v),b.fillRect(p+_-c,m,c,v),b.fillStyle=o,b.globalAlpha=.9,b.fillRect(p+_-c,m,c,l((1-d/y)*v))}}},i)},9810:function(n,i,o){"use strict";var s=o(1885);n.exports=toPX;var a=getSizeBrutal("in",document.body);function getPropertyInPX(n,i){var o=s(getComputedStyle(n).getPropertyValue(i));return o[0]*toPX(o[1],n)}function getSizeBrutal(n,i){var o=document.createElement("div");o.style.height="128"+n,i.appendChild(o);var s=getPropertyInPX(o,"height")/128;return i.removeChild(o),s}function toPX(n,i){if(!n)return null;switch(i=i||document.body,n=(n+""||"px").trim().toLowerCase(),(i===window||i===document)&&(i=document.body),n){case"%":return i.clientHeight/100;case"ch":case"ex":return getSizeBrutal(n,i);case"em":return getPropertyInPX(i,"font-size");case"rem":return getPropertyInPX(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return a;case"cm":return a/2.54;case"mm":return a/25.4;case"pt":return a/72;case"pc":return a/6;case"px":return 1}var o=s(n);if(!isNaN(o[0])&&o[1]){var l=toPX(o[1],i);return"number"==typeof l?o[0]*l:null}return null}},8786:function(n,i,o){"use strict";n.exports=function(n){var i=(n=n||{}).center||[0,0,0],o=n.up||[0,1,0],s=n.right||findOrthoPair(o),a=n.radius||1,l=n.theta||0,h=n.phi||0;if(i=[].slice.call(i,0,3),u(o=[].slice.call(o,0,3),o),u(s=[].slice.call(s,0,3),s),"eye"in n){var f=n.eye,p=[f[0]-i[0],f[1]-i[1],f[2]-i[2]];c(s,p,o),1e-6>len3(s[0],s[1],s[2])?s=findOrthoPair(o):u(s,s),a=len3(p[0],p[1],p[2]);var m=d(o,p)/a,_=d(s,p)/a;h=Math.acos(m),l=Math.acos(_)}return a=Math.log(a),new TurntableController(n.zoomMin,n.zoomMax,i,o,s,a,l,h)};var s=o(4173),a=o(4481),l=o(397),c=o(3858),u=o(91),d=o(8368);function len3(n,i,o){return Math.sqrt(Math.pow(n,2)+Math.pow(i,2)+Math.pow(o,2))}function clamp1(n){return Math.min(1,Math.max(-1,n))}function findOrthoPair(n){var i=Math.abs(n[0]),o=Math.abs(n[1]),s=Math.abs(n[2]),a=[0,0,0];i>Math.max(o,s)?a[2]=1:o>Math.max(i,s)?a[0]=1:a[1]=1;for(var l=0,c=0,d=0;d<3;++d)l+=n[d]*n[d],c+=a[d]*n[d];for(var d=0;d<3;++d)a[d]-=c/l*n[d];return u(a,a),a}function TurntableController(n,i,o,a,l,c,u,d){this.center=s(o),this.up=s(a),this.right=s(l),this.radius=s([c]),this.angle=s([u,d]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(n,i),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=Array(16);for(var h=0;h<16;++h)this.computedMatrix[h]=.5;this.recalcMatrix(0)}var h=TurntableController.prototype;h.setDistanceLimits=function(n,i){n=n>0?Math.log(n):-1/0,i=Math.max(i=i>0?Math.log(i):1/0,n),this.radius.bounds[0][0]=n,this.radius.bounds[1][0]=i},h.getDistanceLimits=function(n){var i=this.radius.bounds[0];return n?(n[0]=Math.exp(i[0][0]),n[1]=Math.exp(i[1][0]),n):[Math.exp(i[0][0]),Math.exp(i[1][0])]},h.recalcMatrix=function(n){this.center.curve(n),this.up.curve(n),this.right.curve(n),this.radius.curve(n),this.angle.curve(n);for(var i=this.computedUp,o=this.computedRight,s=0,a=0,l=0;l<3;++l)a+=i[l]*o[l],s+=i[l]*i[l];for(var d=Math.sqrt(s),h=0,l=0;l<3;++l)o[l]-=i[l]*a/s,h+=o[l]*o[l],i[l]/=d;for(var f=Math.sqrt(h),l=0;l<3;++l)o[l]/=f;var p=this.computedToward;c(p,i,o),u(p,p);for(var m=Math.exp(this.computedRadius[0]),_=this.computedAngle[0],v=this.computedAngle[1],g=Math.cos(_),b=Math.sin(_),y=Math.cos(v),x=Math.sin(v),w=this.computedCenter,C=g*y,M=b*y,E=-g*x,S=-b*x,k=this.computedEye,A=this.computedMatrix,l=0;l<3;++l){var T=C*o[l]+M*p[l]+x*i[l];A[4*l+1]=E*o[l]+S*p[l]+y*i[l],A[4*l+2]=T,A[4*l+3]=0}var L=A[1],O=A[5],R=A[9],P=A[2],B=A[6],D=A[10],N=O*D-R*B,I=R*P-L*D,H=L*B-O*P,U=len3(N,I,H);N/=U,I/=U,H/=U,A[0]=N,A[4]=I,A[8]=H;for(var l=0;l<3;++l)k[l]=w[l]+A[2+4*l]*m;for(var l=0;l<3;++l){for(var h=0,V=0;V<3;++V)h+=A[l+4*V]*k[V];A[12+l]=-h}A[15]=1},h.getMatrix=function(n,i){this.recalcMatrix(n);var o=this.computedMatrix;if(i){for(var s=0;s<16;++s)i[s]=o[s];return i}return o};var f=[0,0,0];h.rotate=function(n,i,o,s){if(this.angle.move(n,i,o),s){this.recalcMatrix(n);var a=this.computedMatrix;f[0]=a[2],f[1]=a[6],f[2]=a[10];for(var c=this.computedUp,u=this.computedRight,d=this.computedToward,h=0;h<3;++h)a[4*h]=c[h],a[4*h+1]=u[h],a[4*h+2]=d[h];l(a,a,s,f);for(var h=0;h<3;++h)c[h]=a[4*h],u[h]=a[4*h+1];this.up.set(n,c[0],c[1],c[2]),this.right.set(n,u[0],u[1],u[2])}},h.pan=function(n,i,o,s){i=i||0,o=o||0,s=s||0,this.recalcMatrix(n);var a=this.computedMatrix;this.computedRadius[0];var l=a[1],c=a[5],u=a[9],d=len3(l,c,u);l/=d,c/=d,u/=d;var h=a[0],f=a[4],p=a[8],m=h*l+f*c+p*u,_=len3(h-=l*m,f-=c*m,p-=u*m),v=(h/=_)*i+l*o,g=(f/=_)*i+c*o,b=(p/=_)*i+u*o;this.center.move(n,v,g,b);var y=Math.exp(this.computedRadius[0]);y=Math.max(1e-4,y+s),this.radius.set(n,Math.log(y))},h.translate=function(n,i,o,s){this.center.move(n,i||0,o||0,s||0)},h.setMatrix=function(n,i,o,s){var l,c,u=1;"number"==typeof o&&(u=0|o),(u<0||u>3)&&(u=1);var d=(u+2)%3;i||(this.recalcMatrix(n),i=this.computedMatrix);var h=i[u],f=i[u+4],p=i[u+8];if(s){var m=Math.abs(h),_=Math.abs(p),v=Math.max(m,Math.abs(f),_);m===v?(h=h<0?-1:1,f=p=0):_===v?(p=p<0?-1:1,h=f=0):(f=f<0?-1:1,h=p=0)}else{var g=len3(h,f,p);h/=g,f/=g,p/=g}var b=i[d],y=i[d+4],x=i[d+8],w=b*h+y*f+x*p,C=len3(b-=h*w,y-=f*w,x-=p*w);b/=C,y/=C;var M=f*(x/=C)-p*y,E=p*b-h*x,S=h*y-f*b,k=len3(M,E,S);if(M/=k,E/=k,S/=k,this.center.jump(n,j,X,q),this.radius.idle(n),this.up.jump(n,h,f,p),this.right.jump(n,b,y,x),2===u){var A=i[1],T=i[5],L=i[9],O=A*b+T*y+L*x,R=A*M+T*E+L*S;l=N<0?-Math.PI/2:Math.PI/2,c=Math.atan2(R,O)}else{var P=i[2],B=i[6],D=i[10],N=P*h+B*f+D*p,I=P*b+B*y+D*x,H=P*M+B*E+D*S;l=Math.asin(clamp1(N)),c=Math.atan2(H,I)}this.angle.jump(n,c,l),this.recalcMatrix(n);var U=i[2],V=i[6],F=i[10],G=this.computedMatrix;a(G,i);var z=G[15],j=G[12]/z,X=G[13]/z,q=G[14]/z,K=Math.exp(this.computedRadius[0]);this.center.jump(n,j-U*K,X-V*K,q-F*K)},h.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},h.idle=function(n){this.center.idle(n),this.up.idle(n),this.right.idle(n),this.radius.idle(n),this.angle.idle(n)},h.flush=function(n){this.center.flush(n),this.up.flush(n),this.right.flush(n),this.radius.flush(n),this.angle.flush(n)},h.setDistance=function(n,i){i>0&&this.radius.set(n,Math.log(i))},h.lookAt=function(n,i,o,s){this.recalcMatrix(n),i=i||this.computedEye,o=o||this.computedCenter;var a=(s=s||this.computedUp)[0],l=s[1],c=s[2],u=len3(a,l,c);if(!(u<1e-6)){a/=u,l/=u,c/=u;var d=i[0]-o[0],h=i[1]-o[1],f=i[2]-o[2],p=len3(d,h,f);if(!(p<1e-6)){d/=p,h/=p,f/=p;var m=this.computedRight,_=m[0],v=m[1],g=m[2],b=a*_+l*v+c*g,y=len3(_-=b*a,v-=b*l,g-=b*c);if(!(y<.01&&(y=len3(_=l*f-c*h,v=c*d-a*f,g=a*h-l*d))<1e-6)){_/=y,v/=y,g/=y,this.up.set(n,a,l,c),this.right.set(n,_,v,g),this.center.set(n,o[0],o[1],o[2]),this.radius.set(n,Math.log(p));var x=l*g-c*v,w=c*_-a*g,C=a*v-l*_,M=len3(x,w,C),E=a*d+l*h+c*f,S=_*d+v*h+g*f,k=(x/=M)*d+(w/=M)*h+(C/=M)*f,A=Math.asin(clamp1(E)),T=Math.atan2(k,S),L=this.angle._state,O=L[L.length-1],R=L[L.length-2],P=Math.abs((O%=2*Math.PI)+2*Math.PI-T),B=Math.abs(O-T),D=Math.abs(O-2*Math.PI-T);P<B&&(O+=2*Math.PI),D<B&&(O-=2*Math.PI),this.angle.jump(this.angle.lastT(),O,R),this.angle.set(n,T,A)}}}}}}]);